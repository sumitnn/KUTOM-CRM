const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/LazyImage-0RPFLAb2.js","assets/index-0HRytCPr.js","assets/index-DfS9FcIS.css"])))=>i.map(i=>d[i]);
import{u as ee,a as se,Z as te,bP as re,j as e,bQ as T,r as R,L as I,_ as ae,bR as ne,y as h,bS as ie}from"./index-0HRytCPr.js";import{s as $,d as q,$ as le,X as oe,v as F}from"./index--WZidvUd.js";import{T as ce}from"./index-J5dHqBTN.js";import{c as de}from"./index-DU0ZzBer.js";import{getBasePrice as L,calculateGSTForItem as _,calculateDiscountForItem as G,getPriceAfterDiscount as M,calculateItemPrice as E,getActualPrice as xe,getMaxAvailableQuantity as g,getApplicableBulkPrice as O,getGSTPercentage as me}from"./ProductDetailPage-BijY5Ypr.js";/* empty css                      */const ue=R.lazy(()=>ae(()=>import("./LazyImage-0RPFLAb2.js"),__vite__mapDeps([0,1,2]))),ye=()=>{const b=ee(),A=se(),a=te(s=>s.cart.items),[z,{isLoading:Q}]=re(),w=Q,k=a.reduce((s,r)=>{const n=L(r.variant);return s+n*r.quantity},0),y=a.reduce((s,r)=>s+_(r.variant,r.quantity),0),p=a.reduce((s,r)=>s+G(r.variant,r.quantity),0),V=a.reduce((s,r)=>s+M(r.variant,r.quantity),0),W=0,B=k-p+y,P=(s,r)=>{const n=a.find(d=>d.cartItemId===s);if(!n)return;const o=g(n.variant);if(o===0){h.error("Sorry, This Product is currently out of stock");return}if(r>o){h.error(`Only ${o} units available for ${n.name}`);return}const t=O(n.variant,r);b(ie({cartItemId:s,quantity:Math.max(1,r),bulkPrice:t}))},Y=s=>O(s.variant,s.quantity),H=s=>O(s.variant,s.quantity)!==null,U=s=>{b(ne(s))},X=async()=>{var n,o;if(a.filter(t=>{const d=g(t.variant);return t.quantity>d}).length>0){h.error("Some items exceed available stock. Please adjust quantities before checkout.");return}if(a.filter(t=>g(t.variant)===0).length>0){h.error("Some items are out of stock. Please remove them before checkout.");return}try{const t={items:a.map(({id:d,product_id:v,quantity:u,variant:i,bulk_price:x})=>{const N=E(i,u),l=me(i,u),S=_(i,u);return{product_id:v,rolebaseid:d,quantity:u,variant_id:(i==null?void 0:i.id)||null,bulk_price_id:(x==null?void 0:x.id)||null,gst_tax:S||null,gst_percentage:l||null,unit_price:N}}),subtotal:k,shipping:W,gst:y,discount:p,total:B};await z(t).unwrap(),h.success("Order placed successfully!"),b(T())}catch(t){console.error("Checkout error:",t),h.error(((n=t==null?void 0:t.data)==null?void 0:n.message)||((o=t==null?void 0:t.data)==null?void 0:o.error)||"Something went wrong.")}},Z=()=>w?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing..."]}):"Proceed to Checkout",J=()=>e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[60vh] text-center px-4 py-12",children:[e.jsx("div",{className:"w-32 h-32 bg-gradient-to-br from-gray-100 to-gray-200 rounded-full flex items-center justify-center mb-6",children:e.jsx(F,{className:"w-16 h-16 text-gray-400"})}),e.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-3",children:"Your cart is empty"}),e.jsx("p",{className:"text-gray-500 max-w-md mb-8",children:"Looks like you haven't added any items to your cart yet. Start shopping to discover amazing products!"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs(I,{to:"/admin/products",className:"inline-flex items-center px-8 py-3 border border-transparent rounded-lg shadow-sm text-base font-bold text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 cursor-pointer transition-all duration-200 hover:shadow-lg",children:[e.jsx(F,{className:"mr-2"}),"Continue Shopping"]}),e.jsxs("button",{onClick:()=>A(-1),className:"inline-flex items-center px-8 py-3 border border-gray-300 rounded-lg shadow-sm text-base font-bold text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 cursor-pointer transition-all duration-200",children:[e.jsx($,{className:"mr-2"}),"Go to Dashboard Page"]})]})]});return e.jsx("div",{className:"min-h-screen py-4 ",children:e.jsxs("div",{className:"max-w-8xl mx-auto",children:[a.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>A("/admin/products"),className:"btn btn-ghost btn-sm mb-4 cursor-pointer hover:bg-gray-100 transition-colors",children:[e.jsx($,{className:"mr-2"}),"Back to Products"]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-extrabold text-gray-900",children:"Your Shopping Cart"}),e.jsxs("p",{className:"text-gray-500 mt-1 font-medium",children:[a.length," ",a.length===1?"item":"items"]})]}),e.jsxs("button",{onClick:()=>b(T()),className:"mt-2 sm:mt-0 text-red-500 hover:text-red-700 font-medium text-sm flex items-center cursor-pointer transition-colors",children:[e.jsx(q,{className:"mr-1"})," Clear all"]})]})]}),a.length===0?e.jsx(J,{}):e.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[e.jsxs("div",{className:"lg:w-2/3",children:[e.jsx("div",{className:"bg-white shadow-sm rounded-xl overflow-hidden",children:e.jsx("div",{className:"divide-y divide-gray-200",children:a.map(s=>{var D;const r=E(s.variant,s.quantity),n=L(s.variant),o=xe(s.variant),t=Y(s),d=_(s.variant,s.quantity),v=G(s.variant,s.quantity),u=M(s.variant,s.quantity),i=H(s),{cartItemId:x,name:N,quantity:l,image:S,variant:c}=s,f=g(s.variant),C=l>=f,m=f===0,K=i?r*l:o*l;return e.jsxs("div",{className:"p-4 sm:p-6 flex flex-col sm:flex-row group hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex-shrink-0 relative mb-4 sm:mb-0",children:[e.jsx(R.Suspense,{fallback:e.jsx("div",{className:"w-24 h-24 sm:w-32 sm:h-32 bg-gray-200 rounded-lg animate-pulse"}),children:e.jsx(ue,{src:S||"/placeholder.png",alt:N,className:"w-24 h-24 sm:w-32 sm:h-32 rounded-lg object-cover cursor-pointer",onError:j=>{j.target.src.includes("/placeholder.png")||(j.target.onerror=null,j.target.src="/placeholder.png")}})}),(c==null?void 0:c.name)&&e.jsx("span",{className:"absolute top-1 left-1 sm:top-2 sm:left-2 bg-white/90 text-xs font-bold px-2 py-1 rounded-md shadow-sm cursor-default",children:c.name}),m&&e.jsx("span",{className:"absolute top-1 right-1 sm:top-2 sm:right-2 bg-red-500 text-white text-xs font-bold px-2 py-1 rounded-md shadow-sm",children:"Out of Stock"})]}),e.jsxs("div",{className:"sm:ml-6 flex-grow",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-lg font-extrabold text-gray-900 cursor-pointer hover:text-indigo-600 transition-colors line-clamp-2",children:N}),e.jsx("div",{className:`mt-1 text-xs px-2 py-1 rounded inline-block ${m?"bg-red-100 text-red-600":"bg-blue-100 text-blue-600"}`,children:m?"Out of Stock":`Available: ${f} units`}),t&&e.jsxs("div",{className:"mt-1 text-xs text-green-600 bg-green-50 px-2 py-1 rounded inline-block",children:["ðŸŽ‰ Bulk discount: ",t.max_quantity,"+ units",t.discount>0&&` (${t.discount}% off)`,t.gst_percentage>0&&` | GST: ${t.gst_percentage}%`]}),!i&&((D=c==null?void 0:c.product_variant_prices)==null?void 0:D[0])&&e.jsxs("div",{className:"mt-1 text-xs text-blue-600",children:[`GST: ${c.product_variant_prices[0].gst_percentage}%`,c.product_variant_prices[0].discount>0&&` | Discount: ${c.product_variant_prices[0].discount}%`]})]}),e.jsx("button",{onClick:()=>U(x),className:"mt-2 sm:mt-0 sm:ml-4 text-gray-400 hover:text-red-500 transition-colors cursor-pointer p-1 self-start sm:self-center",title:"Remove item",children:e.jsx(q,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"mt-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("button",{onClick:()=>P(x,l-1),className:`p-2 rounded-lg ${l<=1?"text-gray-300 cursor-not-allowed":"text-gray-600 hover:bg-gray-100 cursor-pointer"} transition-colors`,disabled:l<=1||m,children:e.jsx(le,{className:"h-4 w-4"})}),e.jsx("input",{type:"number",min:"1",max:f,value:l,onChange:j=>P(x,Math.max(1,Number(j.target.value))),className:"mx-2 w-14 text-center border border-gray-300 rounded-lg py-2 text-sm font-bold focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",disabled:m}),e.jsx("button",{onClick:()=>P(x,l+1),className:`p-2 rounded-lg ${C||m?"text-gray-300 cursor-not-allowed":"text-gray-600 hover:bg-gray-100 cursor-pointer"} transition-colors`,disabled:C||m,title:C?`Maximum ${f} units available`:m?"Out of stock":"",children:e.jsx(oe,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:i?"Bulk Price":"Unit Price"}),e.jsxs("p",{className:"text-lg font-extrabold text-gray-900",children:["â‚¹",i?r.toFixed(2):o.toFixed(2),i&&r<n&&e.jsxs("span",{className:"ml-1 text-sm text-gray-500 line-through",children:["â‚¹",n.toFixed(2)]}),!i&&o<n&&e.jsxs("span",{className:"ml-1 text-sm text-gray-500 line-through",children:["â‚¹",n.toFixed(2)]})]}),e.jsxs("div",{className:"text-xs space-y-1 mt-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Original:"}),e.jsxs("span",{children:["â‚¹",(n*l).toFixed(2)]})]}),v>0&&e.jsxs("div",{className:"flex justify-between text-green-600",children:[e.jsx("span",{children:"Discount:"}),e.jsxs("span",{children:["-â‚¹",v.toFixed(2)]})]}),!i&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"After discount:"}),e.jsxs("span",{children:["â‚¹",u.toFixed(2)]})]}),d>0&&e.jsxs("div",{className:"flex justify-between text-blue-600",children:[e.jsx("span",{children:"GST:"}),e.jsxs("span",{children:["+â‚¹",d.toFixed(2)]})]})]}),e.jsxs("p",{className:"text-lg font-bold text-indigo-600 mt-2 border-t pt-2",children:["Total: â‚¹",K.toFixed(2)]}),i&&e.jsx("p",{className:"text-xs text-green-600 mt-1",children:"âœ“ Bulk pricing applied"})]})]})]})]},x)})})}),e.jsxs("div",{className:"mt-6 grid grid-cols-1 sm:grid-cols-3 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"bg-white p-3 sm:p-4 rounded-xl shadow-sm flex items-center",children:[e.jsx(ce,{className:"text-indigo-600 text-xl sm:text-2xl mr-3"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-sm",children:"Bulk Pricing Also Available"}),e.jsx("p",{className:"text-gray-500 text-xs",children:"Special Discount"})]})]}),e.jsxs("div",{className:"bg-white p-3 sm:p-4 rounded-xl shadow-sm flex items-center",children:[e.jsx(F,{className:"text-indigo-600 text-xl sm:text-2xl mr-3"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-sm",children:"Easy Returns"}),e.jsx("p",{className:"text-gray-500 text-xs",children:"15-day return policy"})]})]}),e.jsxs("div",{className:"bg-white p-3 sm:p-4 rounded-xl shadow-sm flex items-center",children:[e.jsx(de,{className:"text-indigo-600 text-xl sm:text-2xl mr-3"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-sm",children:"Secure Checkout"}),e.jsx("p",{className:"text-gray-500 text-xs",children:"100% secure payment"})]})]})]})]}),e.jsx("div",{className:"lg:w-1/3",children:e.jsxs("div",{className:"bg-white shadow-sm rounded-xl overflow-hidden sticky top-6",children:[e.jsx("div",{className:"px-4 sm:px-6 py-4 sm:py-5 border-b border-gray-200",children:e.jsx("h2",{className:"text-xl font-extrabold text-gray-900",children:"Order Summary"})}),e.jsxs("div",{className:"px-4 sm:px-6 py-4 space-y-3 sm:space-y-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("p",{className:"text-gray-600 font-medium",children:["Subtotal (",a.length," items)"]}),e.jsxs("p",{className:"text-gray-900 font-bold",children:["â‚¹",k.toFixed(2)]})]}),p>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("p",{className:"text-gray-600 font-medium",children:"Discount:"}),e.jsxs("p",{className:"text-green-600 font-bold",children:["-â‚¹",p.toFixed(2)]})]}),p>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("p",{className:"text-gray-600 font-medium",children:"Price after discount:"}),e.jsxs("p",{className:"text-gray-900 font-bold",children:["â‚¹",V.toFixed(2)]})]}),y>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("p",{className:"text-gray-600 font-medium",children:"GST:"}),e.jsxs("p",{className:"text-blue-600 font-bold",children:["â‚¹",y.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("p",{className:"text-gray-600 font-medium",children:"Shipping Price:"}),e.jsx("p",{className:"text-red-700 font-bold text-sm",children:"Deduct Later When Order Dispatched"})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-3 sm:pt-4 mt-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("p",{className:"text-lg font-extrabold text-gray-900",children:"Total"}),e.jsxs("p",{className:"text-xl font-extrabold text-indigo-600",children:["â‚¹",B.toFixed(2)]})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1 text-right",children:"(Includes all taxes and discounts)"})]})]}),e.jsxs("div",{className:"px-4 sm:px-6 py-4 border-t border-gray-200",children:[e.jsx("button",{disabled:a.length===0||w||a.some(s=>g(s.variant)===0),className:`w-full flex justify-center items-center px-6 py-3 sm:py-4 border border-transparent rounded-lg shadow-sm text-base font-extrabold text-white ${w||a.length===0||a.some(s=>g(s.variant)===0)?"bg-indigo-300 cursor-not-allowed":"bg-indigo-600 hover:bg-indigo-700 cursor-pointer"} focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors`,onClick:X,children:Z()}),e.jsx("div",{className:"mt-4 flex justify-center",children:e.jsx(I,{to:"/admin/products",className:"text-indigo-600 hover:text-indigo-500 text-sm font-bold cursor-pointer transition-colors",children:"Continue Shopping"})})]})]})})]})]})})};export{ye as default};
