const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-oHO_bMXB.js","assets/index-CdwHP-N2.css","assets/ErrorMessage-C1rBwS37.js","assets/OrderDetailsModal-DdEd8-NK.js","assets/index-DCVWk_eg.js","assets/ModalPortal-CaX2GLzp.js","assets/index-DsfZBStp.js"])))=>i.map(i=>d[i]);
import{r as d,aa as He,az as Ke,ac as We,ad as Ge,j as e,y as p,_ as H}from"./index-oHO_bMXB.js";import{C as Xe,B as Ye,F as we,k as Je,b as Q,l as Ze,O as es,q as ss}from"./index-DCVWk_eg.js";import{M as Ce}from"./ModalPortal-CaX2GLzp.js";import"./index-DsfZBStp.js";const Se=d.lazy(()=>H(()=>import("./index-oHO_bMXB.js").then(K=>K.cH),__vite__mapDeps([0,1]))),as=d.lazy(()=>H(()=>import("./ErrorMessage-C1rBwS37.js"),__vite__mapDeps([2,0,1]))),ts=d.lazy(()=>H(()=>import("./OrderDetailsModal-DdEd8-NK.js"),__vite__mapDeps([3,0,1,4,5,6]))),cs=({role:K})=>{var te,le,ne,ie,re,ce,de,me,oe,xe,he,ue,pe,ge;const[g,De]=d.useState("new"),[w,L]=d.useState(1),[l,v]=d.useState(null),[_,A]=d.useState(""),[j,W]=d.useState(!1),[ke,G]=d.useState(!1),[X,Y]=d.useState(null),[E,J]=d.useState(!1),[b,Z]=d.useState(!1),[x,C]=d.useState(new Set),[y,ee]=d.useState(""),[Fe,Oe]=d.useState(!1),[Ae,T]=d.useState(!1),[h,z]=d.useState(null),[S,D]=d.useState({}),[N,P]=d.useState({courier_name:"",tracking_id:"",transport_charges:"",delivery_date:"",receipt:null}),{data:r,isLoading:R,isError:Ee,refetch:k}=He({status:g,page:w}),[Te]=Ke(),[ze]=We(),[Pe]=Ge(),F=[{id:"new",label:"New Orders",count:((te=r==null?void 0:r.status_counts)==null?void 0:te.new)||0},{id:"accepted",label:"Accepted",count:((le=r==null?void 0:r.status_counts)==null?void 0:le.accepted)||0},{id:"rejected",label:"Rejected",count:((ne=r==null?void 0:r.status_counts)==null?void 0:ne.rejected)||0},{id:"cancelled",label:"Cancelled",count:((ie=r==null?void 0:r.status_counts)==null?void 0:ie.cancelled)||0},{id:"dispatched",label:"Dispatched",count:((re=r==null?void 0:r.status_counts)==null?void 0:re.dispatched)||0},{id:"delivered",label:"Delivered",count:((ce=r==null?void 0:r.status_counts)==null?void 0:ce.delivered)||0}];d.useEffect(()=>{if(b){const s=setTimeout(()=>{Z(!1)},500);return()=>clearTimeout(s)}},[r,b]),d.useEffect(()=>{if(h){const s={};h.items.forEach((a,t)=>{s[t]={batch_number:a.batch_number||"",manufacture_date:a.manufacture_date||"",expiry_date:a.expiry_date||""}}),D(s)}},[h]);const qe=async()=>{J(!0);try{await k(),p.success("Orders refreshed")}catch{p.error("Failed to refresh orders")}finally{J(!1)}},q=s=>{const a=t=>String(t).padStart(2,"0");return`${s.getFullYear()}-${a(s.getMonth()+1)}-${a(s.getDate())}`},M=new Date,se=new Date(M);se.setDate(M.getDate()-6);const Ie=q(se),Le=q(M),B=s=>{Z(!0),De(s),L(1)},ae=async(s,a)=>{var t;if(a!=="dispatched"){if(!_&&["rejected","cancelled"].includes(a)){p.error("Please enter a note for this action");return}C(n=>new Set(n).add(s));try{await Te({orderId:s,status:a,note:_}).unwrap(),p.success(`Order ${a} successfully`),v(null),A(""),k()}catch(n){p.error(((t=n.data)==null?void 0:t.message)||"Something Went Wrong")}finally{C(n=>{const i=new Set(n);return i.delete(s),i})}}},Re=async s=>{var o;const{courier_name:a,tracking_id:t,transport_charges:n,delivery_date:i,receipt:c}=N;if(!a||!t||!n||!i){p.error("Please fill all required fields");return}C(m=>new Set(m).add(s)),W(!0);try{const m=new FormData;m.append("courier_name",a),m.append("tracking_id",t),m.append("transport_charges",n),m.append("delivery_date",i),_&&m.append("note",_),c&&m.append("receipt",c),await ze({orderId:s,data:m}).unwrap(),p.success("Order dispatched successfully"),v(null),P({courier_name:"",tracking_id:"",transport_charges:"",delivery_date:"",receipt:null}),A(""),k()}catch(m){p.error(((o=m.data)==null?void 0:o.message)||"Failed to dispatch order")}finally{W(!1),C(m=>{const f=new Set(m);return f.delete(s),f})}},Me=async s=>{var n;const a=[];let t=!0;if(Object.keys(S).forEach(i=>{const c=S[i];if(!c.batch_number||!c.manufacture_date||!c.expiry_date){t=!1,p.error(`Please fill all batch details for item ${parseInt(i)+1}`);return}a.push({item_id:h.items[i].id,batch_number:c.batch_number,manufacture_date:c.manufacture_date,expiry_date:c.expiry_date})}),!!t){C(i=>new Set(i).add(s));try{await Pe({orderId:s,items:a}).unwrap(),p.success("Batch details updated successfully"),T(!1),z(null),D({}),k()}catch(i){p.error(((n=i.data)==null?void 0:n.message)||"Failed to update batch details")}finally{C(i=>{const c=new Set(i);return c.delete(s),c})}}},$=(s,a,t)=>{D(n=>({...n,[s]:{...n[s],[a]:t}}))},U=s=>new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),I=s=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(s),O=s=>{const{name:a,value:t,files:n}=s.target;P(i=>({...i,[a]:n?n[0]:t}))},Be=()=>N.courier_name&&N.tracking_id&&N.transport_charges&&N.delivery_date,$e=s=>{Y(s),G(!0)},Ue=s=>{z(s),T(!0)},Ve=s=>{var a,t,n,i,c,o,m,f,je,be,Ne,ye;return{id:s.id,date:s.created_at,buyer:{id:((a=s.buyer)==null?void 0:a.id)||"",name:((t=s.buyer)==null?void 0:t.username)||"N/A",email:((n=s.buyer)==null?void 0:n.email)||"N/A",address:((i=s.buyer)==null?void 0:i.address)||{street_address:null,city:null,state:"",district:"",postal_code:null,country:"India"},phone:((c=s.buyer)==null?void 0:c.phone)||"N/A",whatsapp:((o=s.buyer)==null?void 0:o.whatsapp)||"N/A"},seller:{id:((m=s.seller)==null?void 0:m.id)||"",name:((f=s.seller)==null?void 0:f.username)||"N/A",email:((je=s.seller)==null?void 0:je.email)||"N/A",roleId:((be=s.seller)==null?void 0:be.role_based_id)||"N/A",phone:((Ne=s.seller)==null?void 0:Ne.phone)||"N/A"},items:((ye=s.items)==null?void 0:ye.map(u=>{var fe,ve,_e;return{id:u.id,productId:(fe=u.product)==null?void 0:fe.id,productName:(ve=u.product)==null?void 0:ve.name,size:(_e=u.variant)==null?void 0:_e.name,quantity:u.quantity,price:u.unit_price,discount:u.discount||"0",gst_percentage:u.gst_percentage,total:u.final_price,batch_number:u.batch_number,manufacture_date:u.manufacture_date,expiry_date:u.expiry_date,bulk_price_applied:u.bulk_price_applied,discount_percentage:u.discount_percentage,single_quantity_after_gst_and_discount_price:u.single_quantity_after_gst_and_discount_price}}))||[],totalAmount:s.total_price,subtotal:s.subtotal||s.total_price,gstAmount:s.gst_amount||"0.00",discountAmount:s.discount_amount||"0.00",status:s.status,statusDisplay:s.status_display,paymentStatus:s.payment_status,paymentStatusDisplay:s.payment_status_display,description:s.description||"Order placed",courier_name:s.courier_name,tracking_number:s.tracking_number,transport_charges:s.transport_charges||"0.00",expected_delivery_date:s.expected_delivery_date,receipt:s.receipt,note:s.note||""}},V=((de=r==null?void 0:r.results)==null?void 0:de.filter(s=>{var a,t,n,i,c;return s.id.toString().includes(y)||((t=(a=s.buyer)==null?void 0:a.username)==null?void 0:t.toLowerCase().includes(y.toLowerCase()))||((i=(n=s.buyer)==null?void 0:n.email)==null?void 0:i.toLowerCase().includes(y.toLowerCase()))||((c=s.items)==null?void 0:c.some(o=>{var m,f;return(f=(m=o.product)==null?void 0:m.name)==null?void 0:f.toLowerCase().includes(y.toLowerCase())}))}))||[],Qe=s=>{var i;const a=s.items.reduce((c,o)=>c+o.quantity,0),t=(i=s.items[0])==null?void 0:i.product,n=[...new Set(s.items.map(c=>c.product.name))];return{totalItems:a,productName:n.length>1?`${t.name} + ${n.length-1} more`:(t==null?void 0:t.name)||"N/A",productCount:n.length}};return e.jsxs("div",{className:"py-4 max-w-8xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4 mb-6",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-800",children:"Orders Management"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Manage and track your orders efficiently"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 w-full lg:w-auto",children:[e.jsx("div",{className:"relative flex-1 sm:flex-none",children:e.jsxs("div",{className:"relative",children:[e.jsx(Xe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:18}),e.jsx("input",{type:"text",placeholder:"Search orders...",value:y,onChange:s=>ee(s.target.value),className:"input input-bordered pl-10 pr-4 w-full bg-white/80 backdrop-blur-sm"})]})}),e.jsxs("button",{className:"btn btn-outline gap-2",onClick:()=>Oe(!Fe),children:[e.jsx(Ye,{size:16}),e.jsx("span",{className:"hidden sm:inline",children:"Filter"})]}),e.jsx("button",{className:"btn btn-ghost gap-2 bg-white/80 backdrop-blur-sm border border-gray-200",onClick:qe,disabled:R||E,children:E?e.jsxs(e.Fragment,{children:[e.jsx(we,{className:"animate-spin",size:16}),e.jsx("span",{className:"hidden sm:inline",children:"Refreshing..."})]}):R?"Loading...":e.jsxs(e.Fragment,{children:[e.jsx(we,{size:16}),e.jsx("span",{className:"hidden sm:inline",children:"Refresh"})]})})]})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-3 mb-6",children:F.map(s=>e.jsx("div",{className:`bg-white/80 backdrop-blur-sm rounded-xl p-4 border-2 cursor-pointer transition-all duration-200 ${g===s.id?"border-primary shadow-lg scale-105":"border-gray-200 hover:border-gray-300 hover:shadow-md"}`,onClick:()=>B(s.id),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:s.label}),e.jsx("p",{className:"text-2xl font-bold text-gray-800 mt-1",children:s.count})]}),b&&g===s.id&&e.jsx("span",{className:"loading loading-spinner loading-sm text-primary"})]})},s.id))}),e.jsx("div",{className:"lg:hidden mb-4",children:e.jsx("select",{className:"select select-bordered w-full bg-white/80 backdrop-blur-sm",value:g,onChange:s=>B(s.target.value),disabled:b,children:F.map(s=>e.jsx("option",{value:s.id,children:s.label},s.id))})}),e.jsx("div",{className:"hidden lg:flex bg-white/80 backdrop-blur-sm rounded-xl p-1 border border-gray-200 mb-6",children:F.map(s=>e.jsx("button",{className:`flex-1 px-4 py-3 font-medium cursor-pointer text-sm transition-all duration-200 rounded-lg mx-1 ${g===s.id?"bg-primary text-white shadow-lg":"text-gray-600 hover:text-gray-800 hover:bg-gray-100"}`,onClick:()=>B(s.id),disabled:b,children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[b&&g===s.id&&e.jsx("span",{className:"loading loading-spinner loading-xs"}),s.label]})},s.id))}),b&&e.jsx("div",{className:"fixed inset-0 bg-white bg-opacity-70 flex items-center justify-center z-40 rounded-lg",children:e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:"loading loading-spinner loading-lg text-primary mb-2"}),e.jsx("p",{className:"text-gray-600",children:"Loading orders..."})]})}),e.jsx("div",{className:"bg-white/80 backdrop-blur-sm rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:e.jsx(d.Suspense,{fallback:e.jsx("div",{className:"flex justify-center items-center p-8",children:e.jsx(Se,{})}),children:R||b?e.jsx("div",{className:"flex justify-center items-center p-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Se,{}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Loading orders..."})]})}):Ee?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(as,{message:"Failed to load vendor orders"}),e.jsx("button",{className:"btn btn-outline mt-4",onClick:k,disabled:E,children:E?"Retrying...":"Retry"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table table-auto w-full",children:[e.jsx("thead",{className:"bg-gray-50/80",children:e.jsxs("tr",{children:[e.jsx("th",{className:"w-12 text-left py-4 px-4",children:"#"}),e.jsx("th",{className:"text-left py-4 px-4",children:"Order ID"}),e.jsx("th",{className:"text-left py-4 px-4 hidden lg:table-cell",children:"Date"}),e.jsx("th",{className:"text-left py-4 px-4",children:"Customer"}),e.jsx("th",{className:"text-left py-4 px-4 hidden md:table-cell",children:"Product Info"}),e.jsx("th",{className:"text-center py-4 px-4 hidden sm:table-cell",children:"Qty"}),e.jsx("th",{className:"text-left py-4 px-4 hidden xl:table-cell",children:"Total Items"}),e.jsx("th",{className:"text-left py-4 px-4",children:"Total Price"}),e.jsx("th",{className:"text-left py-4 px-4",children:"Status"}),e.jsx("th",{className:"text-center py-4 px-4",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:V.length>0?V.map((s,a)=>{var n,i,c,o;const t=Qe(s);return e.jsxs("tr",{className:"hover:bg-gray-50/50 transition-colors",children:[e.jsx("td",{className:"py-4 px-4 font-medium",children:a+1+(w-1)*10}),e.jsx("td",{className:"py-4 px-4",children:e.jsxs("div",{className:"font-semibold text-primary",children:["#",s.id]})}),e.jsx("td",{className:"py-4 px-4 hidden lg:table-cell",children:e.jsx("div",{className:"text-sm text-gray-600",children:U(s.created_at)})}),e.jsx("td",{className:"py-4 px-4",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:(n=s.buyer)==null?void 0:n.username}),e.jsx("div",{className:"text-xs text-gray-500 truncate max-w-[120px]",children:(i=s.buyer)==null?void 0:i.email})]})}),e.jsx("td",{className:"py-4 px-4 hidden md:table-cell",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 truncate max-w-[150px]",children:t.productName}),e.jsxs("div",{className:"text-xs text-gray-500 space-y-0.5",children:[e.jsxs("div",{children:["SKU: ",(o=(c=s.items[0])==null?void 0:c.product)==null?void 0:o.sku]}),e.jsxs("div",{children:["Items: ",t.productCount," product(s)"]})]})]})}),e.jsx("td",{className:"py-4 px-4 text-center hidden sm:table-cell",children:e.jsx("span",{className:"bg-gray-100 text-gray-800 px-2 py-1 rounded-full text-sm font-medium",children:t.totalItems})}),e.jsx("td",{className:"py-4 px-4 hidden xl:table-cell",children:e.jsxs("div",{className:"font-medium text-gray-900",children:[s.items.length," items"]})}),e.jsx("td",{className:"py-4 px-4",children:e.jsx("div",{className:"font-bold text-gray-900",children:Math.round((s==null?void 0:s.transport_charges)>0?parseInt(s==null?void 0:s.total_price)+parseInt(s==null?void 0:s.transport_charges):s==null?void 0:s.total_price)})}),e.jsx("td",{className:"py-4 px-4",children:e.jsx("span",{className:`badge badge-lg font-medium text-xs whitespace-nowrap ${s.status==="delivered"?"badge-success":s.status==="rejected"||s.status==="cancelled"?"badge-error":s.status==="accepted"?"badge-primary":s.status==="dispatched"?"badge-secondary":"badge-warning"}`,children:s.status_display})}),e.jsx("td",{className:"py-4 px-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 justify-center",children:[g==="new"&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:"btn btn-sm btn-success gap-1 flex-1",onClick:()=>ae(s.id,"accepted"),disabled:x.has(s.id),children:[x.has(s.id)?e.jsx("span",{className:"loading loading-spinner loading-xs"}):e.jsx(Je,{size:14}),e.jsx("span",{className:"hidden xs:inline",children:"Accept"})]}),e.jsxs("button",{className:"btn btn-sm btn-error gap-1 flex-1",onClick:()=>v(s),disabled:x.has(s.id),children:[e.jsx(Q,{size:14}),e.jsx("span",{className:"hidden xs:inline",children:"Reject"})]})]}),g==="accepted"&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:"btn btn-sm btn-primary gap-1 flex-1",onClick:()=>v(s),disabled:x.has(s.id),children:[e.jsx(Ze,{size:14}),e.jsx("span",{className:"hidden xs:inline",children:"Dispatch"})]}),e.jsxs("button",{className:"btn btn-sm btn-info gap-1 flex-1",onClick:()=>Ue(s),disabled:x.has(s.id),children:[e.jsx(es,{size:14}),e.jsx("span",{className:"hidden xs:inline",children:"Batch"})]})]}),e.jsxs("button",{className:"btn btn-sm btn-outline gap-1 flex-1",onClick:()=>$e(s),disabled:x.has(s.id),children:[e.jsx(ss,{size:14}),e.jsx("span",{className:"hidden xs:inline",children:"Details"})]})]})})]},s.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:"10",className:"text-center py-12",children:e.jsxs("div",{className:"flex flex-col items-center justify-center gap-3",children:[e.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-10 h-10 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1",d:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:"No orders found"}),e.jsx("p",{className:"text-gray-500 max-w-md text-center",children:y?`No orders matching "${y}" in ${(me=F.find(s=>s.id===g))==null?void 0:me.label.toLowerCase()}`:`No ${(oe=F.find(s=>s.id===g))==null?void 0:oe.label.toLowerCase()} available`}),y&&e.jsx("button",{className:"btn btn-ghost btn-sm mt-2",onClick:()=>ee(""),children:"Clear search"})]})})})})]})}),(r==null?void 0:r.count)>0&&e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center p-4 border-t border-gray-200 gap-4",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Showing ",e.jsx("span",{className:"font-semibold",children:(w-1)*10+1})," to"," ",e.jsx("span",{className:"font-semibold",children:(w-1)*10+(V.length||0)})," of"," ",e.jsx("span",{className:"font-semibold",children:r.count})," entries"]}),e.jsxs("div",{className:"join",children:[e.jsx("button",{className:"join-item btn btn-sm btn-ghost",disabled:w===1||!r.previous||b,onClick:()=>L(s=>Math.max(1,s-1)),children:"«"}),e.jsx("button",{className:"join-item btn btn-sm bg-primary text-white border-primary",children:w}),e.jsx("button",{className:"join-item btn btn-sm btn-ghost",disabled:!r.next||b,onClick:()=>L(s=>s+1),children:"»"})]})]})]})})}),l&&e.jsx(Ce,{children:e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:l.status==="new"?"Reject Order":l.status==="accepted"?"Dispatch Order":"Order Details"}),e.jsx("button",{onClick:()=>{v(null),P({courier_name:"",tracking_id:"",transport_charges:"",delivery_date:"",receipt:null})},className:"btn btn-sm btn-circle btn-ghost",disabled:j,children:e.jsx(Q,{size:20})})]}),l.status==="accepted"?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"font-bold text-lg mb-3 text-gray-700",children:"Order Summary"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-700",children:"Order ID"}),e.jsxs("p",{className:"font-medium",children:["#",l.id]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-700",children:"Order Created Date"}),e.jsx("p",{className:"font-medium",children:U(l.created_at)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-700 ",children:"Total Amount"}),e.jsx("p",{className:"font-bold",children:l.total_price})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"font-bold text-lg mb-3 text-gray-700",children:"Products"}),e.jsx("div",{className:"space-y-4",children:l.items.map((s,a)=>{var t;return e.jsx("div",{className:"flex items-start gap-4 p-3 bg-white rounded border border-gray-100",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"font-medium",children:[s.product.name," - ",(t=s.variant)==null?void 0:t.name]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-2 mt-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"SKU"}),e.jsx("p",{className:"font-bold text-gray-500",children:s.variant.sku||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Quantity"}),e.jsx("p",{className:"font-bold text-gray-500",children:s.quantity})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Base Price"}),e.jsx("p",{className:"font-bold text-gray-500",children:s.unit_price})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 ",children:"After GST & Discount "}),e.jsx("p",{className:"font-bold text-gray-500",children:((s.unit_price-s.unit_price*s.discount_percentage/100)*(1+s.gst_percentage/100)).toFixed(2)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Total"}),e.jsx("p",{className:"font-bold text-gray-500",children:s.final_price})]})]})]})},a)})})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"font-bold text-lg mb-3 text-gray-700",children:"Customer Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium mb-2 text-gray-600",children:"Contact Details"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Name: "}),((xe=l.buyer)==null?void 0:xe.username)||"N/A"]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Email: "}),((he=l.buyer)==null?void 0:he.email)||"N/A"]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Phone: "}),((ue=l.buyer)==null?void 0:ue.phone)||"N/A"]})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium mb-2 text-gray-600",children:"Shipping Address"}),(pe=l.buyer)!=null&&pe.address?e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{children:l.buyer.address.street_address||"N/A"}),e.jsxs("p",{children:[l.buyer.address.city,",",l.buyer.address.district&&` ${l.buyer.address.district},`,l.buyer.address.state&&` ${l.buyer.address.state},`]}),e.jsxs("p",{children:[l.buyer.address.postal_code&&`${l.buyer.address.postal_code},`,l.buyer.address.country]})]}):e.jsx("p",{className:"text-gray-500",children:"No address provided"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"font-bold text-lg mb-3 text-gray-700",children:"Dispatch Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsxs("span",{className:"label-text font-medium",children:["Courier Name ",e.jsx("span",{className:"text-red-500",children:"*"})]})}),e.jsx("input",{type:"text",name:"courier_name",value:N.courier_name,onChange:O,className:"input input-bordered w-full",placeholder:"e.g. FedEx, UPS, DHL",required:!0,disabled:j})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsxs("span",{className:"label-text font-medium",children:["Tracking ID ",e.jsx("span",{className:"text-red-500",children:"*"})]})}),e.jsx("input",{type:"text",name:"tracking_id",value:N.tracking_id,onChange:O,className:"input input-bordered w-full",placeholder:"Enter tracking number",required:!0,disabled:j})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsxs("span",{className:"label-text font-medium",children:["Shipping Cost ",e.jsx("span",{className:"text-red-500",children:"*"})]})}),e.jsx("input",{type:"number",name:"transport_charges",value:N.transport_charges,onChange:O,className:"input input-bordered w-full",placeholder:"Enter shipping cost",min:"0",step:"0.01",required:!0,disabled:j})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsxs("span",{className:"label-text font-medium",children:["Delivery Date ",e.jsx("span",{className:"text-red-500",children:"*"})]})}),e.jsx("input",{type:"date",name:"delivery_date",value:N.delivery_date,onChange:O,className:"input input-bordered w-full",required:!0,min:Ie,max:Le,disabled:j})]}),e.jsxs("div",{className:"form-control md:col-span-2",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text font-medium",children:"Shipping Receipt (Optional)"})}),e.jsx("input",{type:"file",name:"receipt",onChange:O,className:"file-input file-input-bordered w-full",accept:".pdf,.jpg,.jpeg,.png",disabled:j}),e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt",children:"Upload receipt or proof of shipment"})})]}),e.jsxs("div",{className:"form-control md:col-span-2",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text font-medium",children:"Notes"})}),e.jsx("textarea",{className:"textarea textarea-bordered h-24",placeholder:"Enter any additional notes for this dispatch...",value:_,onChange:s=>A(s.target.value),disabled:j})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx("button",{onClick:()=>{v(null),P({courier_name:"",tracking_id:"",transport_charges:"",delivery_date:"",receipt:null})},className:"btn btn-ghost",disabled:j,children:"Cancel"}),e.jsx("button",{onClick:()=>Re(l.id),className:"btn btn-primary",disabled:!Be()||j,children:j?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"loading loading-spinner"}),"Dispatching..."]}):"Confirm Dispatch"})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsxs("h4",{className:"font-bold text-lg mb-2 text-gray-700",children:["Order #",l.id]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Order Date"}),e.jsx("p",{className:"font-medium",children:U(l.created_at)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Status"}),e.jsx("p",{className:"font-medium capitalize",children:l.status_display})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"font-bold text-lg mb-2 text-gray-700",children:"Products"}),e.jsx("div",{className:"space-y-3",children:l.items.map((s,a)=>{var t;return e.jsx("div",{className:"flex items-start gap-4 p-3 bg-white rounded border border-gray-100",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"font-medium",children:[s.product.name," - ",(t=s.variant)==null?void 0:t.name]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 mt-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Quantity"}),e.jsx("p",{children:s.quantity})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Price"}),e.jsx("p",{children:I(s.unit_price)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Total"}),e.jsx("p",{children:I(s.final_price||s.unit_price*s.quantity)})]})]})]})},a)})})]}),(l.status==="new"||l.status==="accepted")&&e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsxs("span",{className:"label-text font-medium",children:[l.status==="new"?"Reason for Rejection":"Dispatch Notes",e.jsx("span",{className:"text-red-500",children:"*"})]})}),e.jsx("textarea",{className:"textarea textarea-bordered h-24",placeholder:l.status==="new"?"Please provide reason for rejecting this order...":"Enter any notes about this dispatch...",value:_,onChange:s=>A(s.target.value),required:!0,disabled:x.has(l.id)})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx("button",{onClick:()=>v(null),className:"btn btn-ghost",disabled:x.has(l.id),children:"Cancel"}),l.status==="new"&&e.jsx("button",{onClick:()=>ae(l.id,"rejected"),className:"btn btn-error",disabled:!_||x.has(l.id),children:x.has(l.id)?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"loading loading-spinner loading-xs"}),"Processing..."]}):"Confirm Rejection"})]})]})]})})}),Ae&&h&&e.jsx(Ce,{children:e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Manage Batch Details"}),e.jsx("button",{onClick:()=>{T(!1),z(null),D({})},className:"btn btn-sm btn-circle btn-ghost",disabled:x.has(h.id),children:e.jsx(Q,{size:20})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsxs("h4",{className:"font-bold text-lg mb-3 text-gray-700",children:["Order #",h.id]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Customer"}),e.jsx("p",{className:"font-medium",children:(ge=h.buyer)==null?void 0:ge.username})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Total Items"}),e.jsx("p",{className:"font-medium",children:h.items.length})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-bold text-lg text-gray-700",children:"Product Batch Details"}),h.items.map((s,a)=>{var t,n,i,c;return e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("h5",{className:"font-semibold text-gray-800",children:[s.product.name," - ",(t=s.variant)==null?void 0:t.name]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Quantity"}),e.jsx("p",{children:s.quantity})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"SKU"}),e.jsx("p",{children:s.product.sku})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Price"}),e.jsx("p",{children:I(s.unit_price)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Total"}),e.jsx("p",{children:I(s.final_price||s.unit_price*s.quantity)})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsxs("span",{className:"label-text font-medium",children:["Batch Number ",e.jsx("span",{className:"text-red-500",children:"*"})]})}),e.jsx("input",{type:"text",value:((n=S[a])==null?void 0:n.batch_number)||"",onChange:o=>$(a,"batch_number",o.target.value),className:"input input-bordered w-full",placeholder:"Enter batch number",required:!0,disabled:x.has(h.id)})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsxs("span",{className:"label-text font-medium",children:["Manufacture Date ",e.jsx("span",{className:"text-red-500",children:"*"})]})}),e.jsx("input",{type:"date",value:((i=S[a])==null?void 0:i.manufacture_date)||"",onChange:o=>$(a,"manufacture_date",o.target.value),className:"input input-bordered w-full",required:!0,max:q(new Date),disabled:x.has(h.id)})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsxs("span",{className:"label-text font-medium",children:["Expiry Date ",e.jsx("span",{className:"text-red-500",children:"*"})]})}),e.jsx("input",{type:"date",value:((c=S[a])==null?void 0:c.expiry_date)||"",onChange:o=>$(a,"expiry_date",o.target.value),className:"input input-bordered w-full",required:!0,min:q(new Date),disabled:x.has(h.id)})]})]})]},a)})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx("button",{onClick:()=>{T(!1),z(null),D({})},className:"btn btn-ghost",disabled:x.has(h.id),children:"Cancel"}),e.jsx("button",{onClick:()=>Me(h.id),className:"btn btn-primary",disabled:x.has(h.id),children:x.has(h.id)?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"loading loading-spinner"}),"Updating..."]}):"Update Batch Details"})]})]})]})})}),ke&&X&&e.jsx(d.Suspense,{fallback:e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-white rounded-lg p-8",children:e.jsx("span",{className:"loading loading-spinner loading-lg text-primary"})})}),children:e.jsx(ts,{order:Ve(X),onClose:()=>{G(!1),Y(null)}})})]})};export{cs as default};
