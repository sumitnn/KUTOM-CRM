import{r as i,aB as I,aC as N,aD as P,aE as Y,aF as G,aG as O,j as l,y as s}from"./index-0HRytCPr.js";import{V as Q,R as _}from"./RejectReasonModal-Cvx8iv3O.js";import"./format-PgvnqH7J.js";import"./en-US-CEmq6YZe.js";import"./ModalPortal-Boos_dt6.js";import"./index-D-omREhy.js";function X(){const[a,y]=i.useState("new"),[A,p]=i.useState(!1),[g,w]=i.useState(null),[d,j]=i.useState({searchTerm:"",searchType:"email"}),[h,c]=i.useState(!1),[f,o]=i.useState(null),{data:S=[],isLoading:v,refetch:u}=I(["new","pending","rejected"].includes(a)?{status:a,search:d.searchTerm,search_type:d.searchType,role:"vendor"}:null,{skip:!["new","pending","rejected"].includes(a)}),{data:x=[],isLoading:M,refetch:m}=N(["active","suspended"].includes(a)?{status:a,search:d.searchTerm,search_type:d.searchType}:null,{skip:!["active","suspended"].includes(a)}),[R]=P(),[V]=Y(),[T]=G(),[C]=O(),L=v||M,b=()=>["new","pending","rejected"].includes(a)?S:x,k=(e,t)=>{j({searchTerm:e,searchType:t})},K=async e=>{try{e==="all"&&(["new","pending","rejected"].includes(a)?await u():await m(),s.success("Data refreshed successfully"))}catch{s.error("Failed to refresh data")}},U=async e=>{var t;c(!0);try{await C({userId:e}).unwrap(),s.success("KYC marked as completed successfully"),u()}catch(n){s.error(((t=n==null?void 0:n.data)==null?void 0:t.message)||"Something went wrong while verifying KYC")}finally{c(!1)}},F=async(e,t="approve")=>{var n;c(!0),o(t);try{await V(e).unwrap(),s.success(t==="kyc"?"KYC marked as completed successfully":"Application Status Updated"),u()}catch(r){s.error(((n=r==null?void 0:r.data)==null?void 0:n.message)||"Something went wrong")}finally{c(!1),o(null)}},D=async(e,t)=>{var n;c(!0),o("reject");try{await T({id:e,reason:t}).unwrap(),s.success("Application rejected!"),p(!1),u()}catch(r){s.error(((n=r==null?void 0:r.data)==null?void 0:n.message)||"Failed to reject application")}finally{c(!1),o(null)}},E=async e=>{c(!0),o("status");try{await R({id:e,data:{status:a==="active"?"suspended":"active"}}).unwrap(),s.success("User Profile Status Updated"),m()}catch{s.error("Failed to update vendor status")}finally{c(!1),o(null)}};return l.jsxs("div",{className:"py-4",children:[l.jsx("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between mb-4 gap-4",children:l.jsx("h1",{className:"text-xl md:text-2xl font-bold",children:"Vendor Management"})}),l.jsx(Q,{data:b(),activeTab:a,setActiveTab:y,onApprove:F,MarkFullKyc:U,onReject:e=>{["new","pending","rejected"].includes(a)?(w(e),p(!0)):E(e)},onSearch:k,onRefresh:K,isLoading:L,isLoadingAction:h,currentActionId:f,role:"vendor"}),A&&l.jsx(_,{onClose:()=>p(!1),onSubmit:e=>D(g,e),isLoading:h&&f==="reject"})]})}export{X as default};
