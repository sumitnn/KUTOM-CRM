import{r as d,cB as k,y as u,j as e}from"./index-0HRytCPr.js";import{M as E}from"./ModalPortal-Boos_dt6.js";import"./index-D-omREhy.js";const L=({open:x,onClose:p})=>{const[t,j]=d.useState({userEmail:"",amount:"",transactionType:"CREDIT",description:""}),[n,l]=d.useState({}),[c,h]=d.useState({}),[f,{isLoading:i,error:m}]=k();d.useEffect(()=>{x&&(j({userEmail:"",amount:"",transactionType:"CREDIT",description:""}),l({}),h({}))},[x]),d.useEffect(()=>{var s,a;if(m){const r=((s=m.data)==null?void 0:s.message)||"Failed to update wallet. Please try again.";((a=m.data)==null?void 0:a.message)==="User not found."?(l(b=>({...b,userEmail:"User with this email address was not found."})),u.error("❌ User not found. Please check the email address.")):u.error(`❌ ${r}`)}},[m]);const o=(s,a)=>{j(r=>({...r,[s]:a})),n[s]&&l(r=>({...r,[s]:""}))},g=s=>{h(a=>({...a,[s]:!0})),y(s,t[s])},y=(s,a)=>{let r="";switch(s){case"userEmail":a.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a)||(r="Please enter a valid email address"):r="Email address is required";break;case"amount":a.trim()?isNaN(a)||parseFloat(a)<=0?r="Please enter a valid positive amount":parseFloat(a)>1e6&&(r="Amount cannot exceed ₹10,00,000"):r="Amount is required";break;case"description":a.length>200&&(r="Description cannot exceed 200 characters");break}return l(b=>({...b,[s]:r})),!r},w=()=>{const s={};return t.userEmail.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t.userEmail)||(s.userEmail="Please enter a valid email address"):s.userEmail="Email address is required",t.amount.trim()?(isNaN(t.amount)||parseFloat(t.amount)<=0)&&(s.amount="Please enter a valid positive amount"):s.amount="Amount is required",t.description.length>200&&(s.description="Description cannot exceed 200 characters"),l(s),h({userEmail:!0,amount:!0,description:!0}),Object.keys(s).length===0},N=async s=>{if(s.preventDefault(),!w()){u.error("⚠️ Please fix the errors before submitting.");return}try{const a={userEmail:t.userEmail.trim(),data:{amount:parseFloat(t.amount),transaction_type:t.transactionType,transaction_status:"SUCCESS",description:t.description.trim()||`${t.transactionType==="CREDIT"?"Added":"Deducted"} wallet balance`}};await f(a).unwrap();const r=t.transactionType==="CREDIT"?"added to":"deducted from";u.success(`✅ ₹${t.amount} successfully ${r} user's wallet!`),p()}catch(a){console.error("Wallet update error:",a)}},v=s=>{const a="input input-bordered w-full transition-all duration-200";return n[s]&&c[s]?`${a} input-error border-2`:a};return x?e.jsx(E,{children:e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex justify-center items-center p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-md shadow-2xl transform transition-all duration-300 scale-100",onClick:s=>s.stopPropagation(),children:[e.jsx("div",{className:"px-6 py-5 border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-primary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Update Wallet Balance"}),e.jsxs("p",{className:"text-gray-500 text-sm mt-1",children:[t.transactionType==="CREDIT"?"Add funds to":"Deduct funds from"," user wallet"]})]})]}),e.jsx("button",{onClick:p,className:"btn btn-ghost btn-sm btn-circle hover:bg-gray-100 transition-colors",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsxs("form",{onSubmit:N,className:"px-6 py-5 space-y-5",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"label",children:e.jsxs("span",{className:"label-text font-semibold text-gray-700",children:["User Email ",e.jsx("span",{className:"text-red-500",children:"*"})]})}),e.jsx("input",{type:"email",placeholder:"Enter user email address...",className:v("userEmail"),value:t.userEmail,onChange:s=>o("userEmail",s.target.value),onBlur:()=>g("userEmail"),disabled:i}),n.userEmail&&c.userEmail&&e.jsxs("div",{className:"flex items-center gap-2 text-red-600 text-sm mt-1",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),n.userEmail]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"label",children:e.jsxs("span",{className:"label-text font-semibold text-gray-700",children:["Amount (₹) ",e.jsx("span",{className:"text-red-500",children:"*"})]})}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("span",{className:"text-gray-500 font-medium",children:"₹"})}),e.jsx("input",{type:"number",step:"0.01",min:"0",max:"1000000",placeholder:"0.00",className:`${v("amount")}`,value:t.amount,onChange:s=>o("amount",s.target.value),onBlur:()=>g("amount"),disabled:i})]}),n.amount&&c.amount&&e.jsxs("div",{className:"flex items-center gap-2 text-red-600 text-sm mt-1",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),n.amount]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text font-semibold text-gray-700",children:"Transaction Type"})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("label",{className:"flex-1 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"transactionType",value:"CREDIT",checked:t.transactionType==="CREDIT",onChange:s=>o("transactionType",s.target.value),className:"sr-only",disabled:i}),e.jsx("div",{className:`p-4 rounded-lg border-2 text-center transition-all duration-200 ${t.transactionType==="CREDIT"?"border-green-500 bg-green-50 text-green-700 font-semibold":"border-gray-200 bg-gray-50 text-gray-600 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Credit"]})})]}),e.jsxs("label",{className:"flex-1 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"transactionType",value:"DEBIT",checked:t.transactionType==="DEBIT",onChange:s=>o("transactionType",s.target.value),className:"sr-only",disabled:i}),e.jsx("div",{className:`p-4 rounded-lg border-2 text-center transition-all duration-200 ${t.transactionType==="DEBIT"?"border-red-500 bg-red-50 text-red-700 font-semibold":"border-gray-200 bg-gray-50 text-gray-600 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4"})}),"Debit"]})})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"label",children:[e.jsx("span",{className:"label-text font-semibold text-gray-700",children:"Description (Optional)"}),e.jsxs("span",{className:"label-text-alt text-gray-500",children:[t.description.length,"/200"]})]}),e.jsx("textarea",{placeholder:"Add a note about this transaction...",className:`textarea textarea-bordered w-full h-24 resize-none ${n.description?"textarea-error border-2":""}`,value:t.description,onChange:s=>o("description",s.target.value),onBlur:()=>g("description"),disabled:i}),n.description&&c.description&&e.jsxs("div",{className:"flex items-center gap-2 text-red-600 text-sm mt-1",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),n.description]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-100",children:[e.jsx("button",{type:"button",onClick:p,className:"btn btn-ghost px-6 hover:bg-gray-100 transition-colors",disabled:i,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary px-8 gap-2 transition-all duration-200 hover:shadow-lg disabled:opacity-50",disabled:i,children:i?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"loading loading-spinner loading-sm"}),"Processing..."]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),t.transactionType==="CREDIT"?"Add Funds":"Deduct Funds"]})})]})]})]})})}):null};export{L as default};
