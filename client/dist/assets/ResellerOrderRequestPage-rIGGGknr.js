const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-oHO_bMXB.js","assets/index-CdwHP-N2.css","assets/ErrorMessage-C1rBwS37.js"])))=>i.map(i=>d[i]);
import{r,a as z,c9 as V,j as e,y as I,_ as w}from"./index-oHO_bMXB.js";import{B as U,F as G,C as H,h as f,r as y,b,D as Q,e as X,z as J,E as K,G as W,x as v,t as Y}from"./index-DCVWk_eg.js";const Z=r.lazy(()=>w(()=>import("./index-oHO_bMXB.js").then(d=>d.cH),__vite__mapDeps([0,1]))),B=r.lazy(()=>w(()=>import("./ErrorMessage-C1rBwS37.js"),__vite__mapDeps([2,0,1]))),ae=({role:d})=>{const[t,S]=r.useState("pending"),[n,h]=r.useState(1),[o,_]=r.useState(""),[p,C]=r.useState(!1),c=10,R=z(),{data:l={},isLoading:x,isError:F,error:j,refetch:N}=V({status:t,page:n,page_size:c,...o&&{user_email:o}}),u=Array.isArray(l)?l:l.results||l.data||[],m=Array.isArray(l)?l.length:l.count||l.total||0;r.useEffect(()=>{h(1)},[t,o]);const g=s=>{S(s)},q=()=>{N(),I.success("Order requests refreshed!")},k=s=>{s.preventDefault(),N()},D=s=>{const a={pending:{color:"badge-warning",icon:f,text:"Pending"},approved:{color:"badge-success",icon:y,text:"Approved"},rejected:{color:"badge-error",icon:b,text:"Rejected"},cancelled:{color:"badge-neutral",icon:b,text:"Cancelled"}},i=a[s]||a.pending,M=i.icon;return e.jsxs("span",{className:`badge gap-1 ${i.color}`,children:[e.jsx(M,{className:"w-3 h-3"}),i.text]})},E=s=>s?e.jsxs("div",{className:"space-y-2 min-w-[200px]",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{className:"w-3 h-3 text-gray-500"}),e.jsx("span",{className:"font-medium",children:s.username})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(K,{className:"w-3 h-3 text-gray-500"}),e.jsx("span",{className:"text-sm",children:s.email})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(W,{className:"w-3 h-3 text-gray-500"}),e.jsx("span",{className:"text-sm",children:s.phone})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v,{className:"w-3 h-3 text-gray-500"}),e.jsx("span",{className:"text-sm badge badge-outline",children:s.role_based_id})]})]}):"-",A=s=>{if(!s||s.length===0)return"-";const a=s[0];return e.jsxs("div",{className:"space-y-2 min-w-[180px]",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"w-3 h-3 text-gray-500"}),e.jsx("span",{className:"font-medium",children:a.product_name})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v,{className:"w-3 h-3 text-gray-500"}),e.jsx("span",{className:"text-sm",children:a.product_sku})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:`badge badge-xs ${a.product_type==="physical"?"badge-info":"badge-secondary"}`,children:a.product_type})})]})},P=(s,a)=>!s||s.length===0?"-":(s[0],e.jsx("div",{className:"space-y-2 min-w-[150px]",children:e.jsx("div",{className:"flex justify-between items-center pt-1 border-t border-gray-200",children:e.jsxs("span",{className:"font-bold text-primary",children:["₹",a]})})})),T=()=>e.jsxs("tr",{className:"font-bold text-black bg-gray-50",children:[e.jsx("th",{className:"w-12",children:"No."}),e.jsx("th",{children:"Request Date"}),e.jsx("th",{children:"Request ID"}),e.jsx("th",{children:"Reseller Details"}),e.jsx("th",{children:"Product Details"}),e.jsx("th",{children:"Total Amount"}),e.jsx("th",{children:"Status"}),e.jsx("th",{className:"text-center",children:"Actions"})]}),$=s=>{const a=d==="reseller"?`/reseller/my-order-request/${s}`:`/reseller/order-request/${s}`;R(a)},O=(s,a)=>e.jsxs("tr",{className:"hover:bg-gray-50 border-b border-gray-100",children:[e.jsx("td",{className:"font-bold py-4",children:(n-1)*c+a+1}),e.jsx("td",{className:"py-4",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium",children:new Date(s.created_at).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}),e.jsx("span",{className:"text-xs text-gray-500",children:new Date(s.created_at).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})})]})}),e.jsx("td",{className:"font-extrabold text-sm py-4",children:s.request_id}),e.jsx("td",{className:"py-4",children:E(s.requested_by)}),e.jsx("td",{className:"py-4",children:A(s.items)}),e.jsx("td",{className:"py-4",children:P(s.items,s.total_amount)}),e.jsx("td",{className:"py-4 font-bold",children:D(s.status)}),e.jsx("td",{className:"text-center py-4",children:e.jsx("button",{onClick:()=>$(s.id),className:"btn btn-ghost btn-xs font-bold tooltip text-info hover:scale-110 transition-transform","data-tip":"View Details",children:e.jsx(X,{className:"w-4 h-4"})})})]},s.id),L=()=>{var s;return x?e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"text-center py-12",children:e.jsx(r.Suspense,{fallback:e.jsx("div",{children:"Loading..."}),children:e.jsx(Z,{})})})}):F?e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"text-center py-12",children:e.jsx(r.Suspense,{fallback:e.jsx("div",{children:"Error loading..."}),children:e.jsx(B,{message:((s=j==null?void 0:j.data)==null?void 0:s.message)||"Failed to load order requests"})})})}):!u||u.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"text-center py-12",children:e.jsxs("div",{className:"flex flex-col items-center justify-center gap-3 text-gray-500",children:[e.jsx(Q,{className:"w-16 h-16 text-gray-300"}),e.jsx("h3",{className:"text-lg font-medium",children:t==="pending"?"No pending requests":t==="approved"?"No approved requests":"No cancelled/rejected requests"}),e.jsx("p",{className:"text-sm max-w-md text-center",children:t==="pending"?"Pending order requests will appear here for review":t==="approved"?"Approved order requests will appear here":"Cancelled or rejected requests will appear here"})]})})}):u.map((a,i)=>O(a,i))};return e.jsxs("div",{className:"py-4 max-w-8xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center mb-6 gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Order Requests Management"}),e.jsx("p",{className:"text-sm text-gray-500",children:d==="stockist"?"Manage all order requests":"View your order requests"})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs("button",{onClick:()=>C(!p),className:`btn gap-2 ${p?"btn-primary":"btn-outline"}`,children:[e.jsx(U,{className:"w-4 h-4"}),"Filters"]}),e.jsxs("button",{onClick:q,className:"btn btn-primary gap-2",disabled:x,children:[e.jsx(G,{className:`w-4 h-4 ${x?"animate-spin":""}`}),x?"Refreshing...":"Refresh"]})]})]}),p&&e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-6 animate-fade-in",children:e.jsx("form",{onSubmit:k,className:"flex flex-col sm:flex-row gap-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text font-medium",children:"Search by Reseller Email"})}),e.jsxs("div",{className:"join w-full",children:[e.jsx("input",{type:"email",placeholder:"Enter reseller email...",value:o,onChange:s=>_(s.target.value),className:"join-item input input-bordered w-full"}),e.jsx("button",{type:"submit",className:"join-item btn btn-primary",children:e.jsx(H,{className:"w-4 h-4"})})]})]})})}),e.jsxs("div",{className:"tabs tabs-boxed bg-gray-100 p-1 rounded-lg mb-6",children:[e.jsxs("button",{className:`tab flex-1 font-medium ${t==="pending"?"tab-active bg-white shadow-sm text-primary":""}`,onClick:()=>g("pending"),children:[e.jsx(f,{className:"mr-2"}),"Pending Requests"]}),e.jsxs("button",{className:`tab flex-1 font-medium ${t==="approved"?"tab-active bg-white shadow-sm text-success":""}`,onClick:()=>g("approved"),children:[e.jsx(y,{className:"mr-2"}),"Approved Requests"]}),e.jsxs("button",{className:`tab flex-1 font-medium ${t==="rejected"?"tab-active bg-white shadow-sm text-error":""}`,onClick:()=>g("rejected"),children:[e.jsx(b,{className:"mr-2"}),"Cancelled/Rejected"]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table w-full",children:[e.jsx("thead",{children:T()}),e.jsx("tbody",{children:L()})]})}),m>c&&e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center p-4 border-t border-gray-100 gap-4",children:[e.jsxs("div",{className:"text-sm text-gray-500 font-bold",children:["Showing ",e.jsx("span",{className:"font-medium",children:(n-1)*c+1})," to"," ",e.jsx("span",{className:"font-medium",children:Math.min(n*c,m)})," of"," ",e.jsx("span",{className:"font-medium",children:m})," entries"]}),e.jsxs("div",{className:"join",children:[e.jsx("button",{className:"join-item btn btn-sm",disabled:n===1,onClick:()=>h(s=>Math.max(1,s-1)),children:"«"}),e.jsx("button",{className:"join-item btn btn-sm btn-active",children:n}),e.jsx("button",{className:"join-item btn btn-sm",disabled:n*c>=m,onClick:()=>h(s=>s+1),children:"»"})]})]})]})]})};export{ae as default};
