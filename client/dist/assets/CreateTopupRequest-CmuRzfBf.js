import{r as o,a as C,cg as M,ch as S,j as e,y as l}from"./index-oHO_bMXB.js";import{M as A}from"./ModalPortal-CaX2GLzp.js";import"./index-DsfZBStp.js";const B=({role:N})=>{const[i,v]=o.useState(""),[c,m]=o.useState(null),[d,x]=o.useState(null),[b,y]=o.useState(""),[t,h]=o.useState(""),[u,p]=o.useState(!1),[g,j]=o.useState(!1),f=C(),{data:s}=M(),[k]=S(),w=a=>{const n=a.target.files[0];if(n){if(n.size>5*1024*1024){l.error("File size should be less than 5MB");return}m(n);const r=new FileReader;r.onloadend=()=>{x(r.result)},r.readAsDataURL(n)}},_=async a=>{var n;if(a.preventDefault(),!i||!c||!t){l.error("Amount, Screenshot and Payment Method are required");return}if(t==="upi"&&!(s!=null&&s.upi_id)){l.error("Please add your UPI ID in profile settings first");return}if(t==="bank"&&!(s!=null&&s.account_number)){l.error("Please add your bank details in profile settings first");return}j(!0);try{const r=new FormData;r.append("amount",i.toString()),r.append("screenshot",c),r.append("note",b),r.append("payment_method",t);const P={method:t,details:t==="upi"?{upi_id:s.upi_id,bank_upi:s.bank_upi}:{account_holder_name:s.account_holder_name,account_number:s.account_number,ifsc_code:s.ifsc_code,bank_name:s.bank_name}};r.append("payment_details",JSON.stringify(P)),await k(r).unwrap(),l.success("Topup request submitted successfully"),f(`/${N}/my-topup-request`)}catch(r){console.error(r),l.error(((n=r==null?void 0:r.data)==null?void 0:n.message)||"Failed to submit request")}finally{j(!1)}};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-50 pt-2 px-4 sm:px-6 lg:px-8 cursor-default",children:e.jsxs("div",{className:"max-w-lg mx-auto w-full",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-extrabold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent",children:"Create Topup Reqeust"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Request wallet topup to admin"})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200",children:e.jsx("div",{className:"p-6",children:e.jsxs("form",{onSubmit:_,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"amount",className:"block text-sm font-semibold text-gray-800 mb-2",children:"Amount (₹) *"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("span",{className:"text-gray-600 font-medium",children:"₹"})}),e.jsx("input",{type:"number",id:"amount",name:"amount",min:"1",className:"w-full pl-10 pr-4 py-3 text-sm border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white transition-all",placeholder:"Enter amount",value:i,onChange:a=>v(a.target.value),required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"Payment Method *"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:`p-3 border-2 rounded-lg cursor-pointer transition-all ${t==="upi"?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-blue-400"}`,children:e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"radio",name:"paymentMethod",className:"h-4 w-4 text-blue-600",checked:t==="upi",onChange:()=>h("upi")}),e.jsxs("div",{className:"ml-3",children:[e.jsx("span",{className:"block text-sm font-medium text-gray-800",children:"UPI"}),(s==null?void 0:s.upi_id)&&e.jsx("p",{className:"text-xs text-green-600 mt-1",children:"✓ Available"})]})]})}),e.jsx("div",{className:`p-3 border-2 rounded-lg cursor-pointer transition-all ${t==="bank"?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-blue-400"}`,children:e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"radio",name:"paymentMethod",className:"h-4 w-4 text-blue-600",checked:t==="bank",onChange:()=>h("bank")}),e.jsxs("div",{className:"ml-3",children:[e.jsx("span",{className:"block text-sm font-medium text-gray-800",children:"Bank Transfer"}),(s==null?void 0:s.account_number)&&e.jsx("p",{className:"text-xs text-green-600 mt-1",children:"✓ Available"})]})]})})]})]}),t&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 border border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-800",children:"Payment Details"}),(s==null?void 0:s.passbook_pic)&&e.jsx("button",{type:"button",onClick:()=>p(!u),className:"text-xs text-blue-600 hover:text-blue-800 font-medium cursor-pointer",children:u?"Hide":"Passbook"})]}),t==="upi"&&(s!=null&&s.upi_id)?e.jsxs("div",{className:"text-xs space-y-1",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"UPI ID:"})," ",s.upi_id]}),s.bank_upi&&e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Bank:"})," ",s.bank_upi]})]}):t==="bank"&&(s!=null&&s.account_number)?e.jsxs("div",{className:"text-xs space-y-1",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-bold",children:"Bank Name:"})," ",s.bank_name]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-bold",children:"Account Holder Name:"})," ",s.account_holder_name]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-bold",children:"Account Number:"})," ",s.account_number]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-bold",children:"IFSC Code:"})," ",s.ifsc_code]})]}):e.jsx("p",{className:"text-xs text-red-600",children:"Please add payment details in profile"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"Payment Proof *"}),e.jsx("div",{className:`border-2 border-dashed rounded-lg transition-all ${d?"border-green-400 bg-green-50":"border-gray-300 bg-gray-50 hover:border-blue-400"}`,children:d?e.jsx("div",{className:"p-3",children:e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:d,alt:"Preview",className:"w-full h-32 object-contain rounded"}),e.jsx("button",{type:"button",onClick:()=>{x(null),m(null)},className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1 hover:bg-red-600 cursor-pointer",children:e.jsx("svg",{className:"h-3 w-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}):e.jsxs("label",{className:"cursor-pointer",children:[e.jsxs("div",{className:"p-4 text-center",children:[e.jsx("svg",{className:"mx-auto h-8 w-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),e.jsx("p",{className:"mt-1 text-xs text-gray-600",children:"Click to upload screenshot"}),e.jsx("p",{className:"text-xs text-gray-500",children:"PNG, JPG up to 5MB"})]}),e.jsx("input",{id:"screenshot",name:"screenshot",type:"file",accept:"image/*",className:"sr-only",onChange:w,required:!0})]})})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"note",className:"block text-sm font-semibold text-gray-800 mb-2",children:"Note (Optional)"}),e.jsx("textarea",{id:"note",name:"note",rows:2,className:"w-full px-3 py-2 text-sm border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none",placeholder:"Additional information...",value:b,onChange:a=>y(a.target.value)})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{type:"button",onClick:()=>f(-1),className:"flex-1 px-4 py-3 border-2 border-gray-300 text-gray-700 bg-white rounded-lg hover:bg-gray-50 font-medium cursor-pointer transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:g||!i||!c||!t||t==="upi"&&!(s!=null&&s.upi_id)||t==="bank"&&!(s!=null&&s.account_number),className:"flex-1 px-4 py-3 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-lg hover:from-blue-700 hover:to-indigo-700 font-medium cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:g?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing"]}):"Submit"})]})]})})}),u&&(s==null?void 0:s.passbook_pic)&&e.jsx(A,{children:e.jsx("div",{className:"fixed inset-0 bg-black/50  flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-sm w-full p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("h3",{className:"font-semibold",children:"Passbook"}),e.jsx("button",{onClick:()=>p(!1),className:"text-gray-500 hover:text-gray-700 cursor-pointer",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("img",{src:s.passbook_pic,alt:"Passbook",className:"w-full rounded border"})]})})})]})})};export{B as default};
