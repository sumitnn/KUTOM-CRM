import{r as x,aM as z,aN as B,j as t,bx as G,F as P}from"./index-oHO_bMXB.js";const Y=({isOpen:v,onClose:y,title:$,fields:j,initialData:m,onSave:q,isLoading:i})=>{const[c,f]=x.useState(m||{}),[N,_]=x.useState({}),[g,w]=x.useState((m==null?void 0:m.state)||""),[o,u]=x.useState({}),{data:A=[]}=z(),{data:T=[]}=B(g,{skip:!g});x.useEffect(()=>{m&&(f(m),w(m.state||""),_({}),u({}))},[m]);const S=e=>e?/^\d{10}$/.test(e)?"":"Must be a 10-digit number":"This field is required",E=e=>e?/^\d{12}$/.test(e)?"":"Must be a 12-digit number":"This field is required",C=(e,s=!0)=>e?/^[A-Z]{5}[0-9]{4}[A-Z]{1}$/.test(e)?"":"Invalid PAN format (e.g., ABCDE1234F)":s?"This field is required":"",Z=e=>e?/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/.test(e)?"":"Invalid GST format (e.g., 22ABCDE1234F1Z5)":"This field is required",k=e=>e?/^\d{6}$/.test(e)?"":"Must be a 6-digit number":"This field is required",I=e=>e?/^[A-Z]{4}0[A-Z0-9]{6}$/.test(e)?"":"Invalid IFSC format (e.g., SBIN0000123)":"This field is required",M=e=>e?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)?"":"Invalid email format":"This field is required",F=(e,s)=>{const a=j.find(n=>n.name===e);if(!a||a.disabled)return"";if(a.type==="file"){if(a.required){const n=typeof c[e]=="string"&&c[e].length>0,r=N[e]instanceof File;if(!n&&!r)return"This field is required"}return""}switch(e){case"phone":case"whatsapp_number":case"company_phone":return S(s);case"adhaar_card_number":return E(s);case"pancard_number":return C(s,!0);case"pan_number":return C(s,!1);case"gst_number":return Z(s);case"postal_code":case"pincode":return k(s);case"ifsc_code":return I(s);case"company_email":case"email":return M(s);case"date_of_birth":if(s){const n=new Date(s),r=new Date;let d=r.getFullYear()-n.getFullYear();const l=r.getMonth()-n.getMonth();if((l<0||l===0&&r.getDate()<n.getDate())&&d--,d<18)return"You must be at least 18 years old"}else if(a.required)return"This field is required";return"";default:return a.required&&!s?"This field is required":""}},p=e=>{const{name:s,value:a,type:n}=e.target;let r=a;(s==="pancard_number"||s==="pan_number"||s==="ifsc_code"||s==="gst_number")&&(r=a.toUpperCase()),n==="tel"||s==="adhaar_card_number"?r=a.replace(/\D/g,"").slice(0,s==="adhaar_card_number"?12:10):(s==="postal_code"||s==="pincode")&&(r=a.replace(/\D/g,"").slice(0,6));const d=F(s,r);u(l=>({...l,[s]:d})),s==="state"?(w(r),f(l=>({...l,[s]:r,district:""}))):f(l=>({...l,[s]:r}))},D=e=>{const{name:s}=e.target,a=e.target.files[0];if(!a)return;const n=j.find(r=>r.name===s);if(n!=null&&n.accept){const r=n.accept.split(","),d=a.type,l=a.name.split(".").pop().toLowerCase();if(!r.some(h=>h.startsWith(".")?l===h.substring(1):d.match(h.replace("*",".*")))){u(h=>({...h,[s]:`Invalid file type. Accepted: ${n.accept}`}));return}}_(r=>({...r,[s]:a})),u(r=>({...r,[s]:void 0}))},V=e=>{e.preventDefault();const s={};let a=!0;if(j.forEach(r=>{if(r.disabled)return;const d=c[r.name],l=F(r.name,d);l&&(s[r.name]=l,a=!1)}),u(s),!a)return;const n={...c,...Object.fromEntries(Object.entries(N).map(([r,d])=>[r,d]))};q(n)},b=e=>({name:"name",email:"email",phone:"tel",whatsapp_number:"tel",company_phone:"tel",address:"street-address",city:"address-level2",state:"address-level1",district:"address-level2",postal_code:"postal-code",pincode:"postal-code",date_of_birth:"bday",adhaar_card_number:"off",pancard_number:"off",pan_number:"off",gst_number:"off",ifsc_code:"off"})[e]||"on";return v?t.jsx("div",{className:"fixed inset-0 backdrop-blur-sm bg-black/30 flex justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-2xl w-full max-w-2xl max-h-[calc(100vh-40px)] overflow-y-auto transform transition-all duration-300 ease-in-out mt-5",children:[t.jsxs("div",{className:"flex justify-between items-center border-b p-4 sticky top-0 bg-white z-10",children:[t.jsx("h3",{className:"text-xl font-bold",children:$}),t.jsx("button",{onClick:y,className:"text-gray-500 hover:text-gray-700 transition-colors cursor-pointer",disabled:i,children:t.jsx(G,{size:20})})]}),t.jsxs("form",{onSubmit:V,className:"p-4 space-y-4",children:[j.map(e=>{const s=`field-${e.name}`;return e.name==="state"?t.jsxs("div",{className:"form-control",children:[t.jsx("label",{htmlFor:s,className:"label cursor-pointer",children:t.jsxs("span",{className:"label-text flex items-center gap-2 font-bold",children:[e.icon," ",e.label,e.required&&t.jsx("span",{className:"text-red-500",children:"*"})]})}),t.jsxs("select",{id:s,name:e.name,value:g,onChange:p,className:`select select-bordered w-full ${o[e.name]?"border-red-500":""} ${e.disabled?"opacity-75 cursor-not-allowed":""}`,required:e.required,disabled:e.disabled||i,autoComplete:b(e.name),children:[t.jsx("option",{value:"",children:"Select State"}),A.map(a=>t.jsx("option",{value:a.id,children:a.name},a.id))]}),o[e.name]&&t.jsx("p",{className:"text-red-500 text-xs mt-1",children:o[e.name]})]},e.name):e.name==="district"?t.jsxs("div",{className:"form-control",children:[t.jsx("label",{htmlFor:s,className:"label cursor-pointer",children:t.jsxs("span",{className:"label-text flex items-center gap-2 font-bold",children:[e.icon," ",e.label,e.required&&t.jsx("span",{className:"text-red-500",children:"*"})]})}),t.jsxs("select",{id:s,name:e.name,value:c.district||"",onChange:p,className:`select select-bordered w-full ${o[e.name]?"border-red-500":""} ${e.disabled?"opacity-75 cursor-not-allowed":""}`,required:e.required,disabled:!g||e.disabled||i,autoComplete:b(e.name),children:[t.jsx("option",{value:"",children:"Select District"}),T.map(a=>t.jsx("option",{value:a.id,children:a.name},a.id))]}),o[e.name]&&t.jsx("p",{className:"text-red-500 text-xs mt-1",children:o[e.name]})]},e.name):t.jsxs("div",{className:"form-control",children:[t.jsx("label",{htmlFor:s,className:"label cursor-pointer",children:t.jsxs("span",{className:"label-text flex items-center gap-2 font-bold",children:[e.icon," ",e.label,e.required&&t.jsx("span",{className:"text-red-500",children:"*"})]})}),e.type==="textarea"?t.jsxs(t.Fragment,{children:[t.jsx("textarea",{id:s,name:e.name,value:c[e.name]||"",onChange:p,className:`textarea textarea-bordered w-full font-bold ${o[e.name]?"border-red-500":""} ${e.disabled?"opacity-75 cursor-not-allowed":""}`,rows:3,disabled:e.disabled||i,autoComplete:b(e.name)}),o[e.name]&&t.jsx("p",{className:"text-red-500 text-xs mt-1",children:o[e.name]})]}):e.type==="select"?t.jsxs(t.Fragment,{children:[t.jsxs("select",{id:s,name:e.name,value:c[e.name]||"",onChange:p,className:`select select-bordered w-full font-bold ${o[e.name]?"border-red-500":""} ${e.disabled?"opacity-75 cursor-not-allowed":""}`,disabled:e.disabled||i,autoComplete:b(e.name),children:[t.jsxs("option",{value:"",children:["Select ",e.label]}),e.options.map(a=>t.jsx("option",{value:a,children:a.split("_").map(n=>n.charAt(0).toUpperCase()+n.slice(1)).join(" ")},a))]}),o[e.name]&&t.jsx("p",{className:"text-red-500 text-xs mt-1",children:o[e.name]})]}):e.type==="file"?t.jsxs(t.Fragment,{children:[t.jsx("input",{type:"file",id:s,name:e.name,onChange:D,className:`file-input file-input-bordered w-full font-bold ${o[e.name]?"border-red-500":""} ${e.disabled?"opacity-75 cursor-not-allowed":""}`,accept:e.accept,disabled:e.disabled||i}),o[e.name]&&t.jsx("p",{className:"text-red-500 text-xs mt-1",children:o[e.name]}),c[e.name]&&typeof c[e.name]=="string"&&t.jsxs("div",{children:[t.jsxs("p",{className:"text-sm text-gray-500 mt-1 font-extrabold",children:["Current file: ",c[e.name].split("/").pop()]}),t.jsx("img",{src:c[e.name],className:"size-20 cursor-pointer",alt:c[e.name].split("/").pop(),onClick:()=>window.open(c[e.name],"_blank")})]})]}):t.jsxs(t.Fragment,{children:[t.jsx("input",{id:s,type:e.type,name:e.name,value:c[e.name]||"",onChange:p,className:`input input-bordered w-full font-bold ${o[e.name]?"border-red-500":""} ${e.disabled?"opacity-75 cursor-not-allowed":""}`,disabled:e.disabled||i,pattern:e.pattern,title:e.title,autoComplete:b(e.name),maxLength:e.name==="pancard_number"||e.name==="pan_number"?10:e.name==="adhaar_card_number"?12:e.name==="postal_code"||e.name==="pincode"?6:e.name==="ifsc_code"?11:e.type==="tel"?10:void 0}),o[e.name]&&t.jsx("p",{className:"text-red-500 text-xs mt-1",children:o[e.name]})]})]},e.name)}),t.jsxs("div",{className:"flex justify-end gap-2 pt-4 sticky bottom-0 bg-white pb-4",children:[t.jsx("button",{type:"button",onClick:y,className:"btn btn-ghost",disabled:i,children:"Cancel"}),t.jsx("button",{type:"submit",className:"btn btn-primary",disabled:i||Object.values(o).some(Boolean),children:i?t.jsxs(t.Fragment,{children:[t.jsx(P,{className:"animate-spin mr-2"}),"Saving..."]}):"Save Changes"})]})]})]})}):null};export{Y as default};
