const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-oHO_bMXB.js","assets/index-CdwHP-N2.css","assets/ErrorMessage-C1rBwS37.js","assets/OrderDetailsModal-DdEd8-NK.js","assets/index-DCVWk_eg.js","assets/ModalPortal-CaX2GLzp.js","assets/index-DsfZBStp.js"])))=>i.map(i=>d[i]);
import{a as Re,r as d,aa as qe,ab as Te,ac as ze,ad as Me,j as e,y as p,_ as H}from"./index-oHO_bMXB.js";import{F as ue,k as Be,O as Ue,l as Ie,q as Le,b as pe}from"./index-DCVWk_eg.js";import{M as je}from"./ModalPortal-CaX2GLzp.js";import"./index-DsfZBStp.js";const ge=d.lazy(()=>H(()=>import("./index-oHO_bMXB.js").then(K=>K.cH),__vite__mapDeps([0,1]))),$e=d.lazy(()=>H(()=>import("./ErrorMessage-C1rBwS37.js"),__vite__mapDeps([2,0,1]))),Ve=d.lazy(()=>H(()=>import("./OrderDetailsModal-DdEd8-NK.js"),__vite__mapDeps([3,0,1,4,5,6]))),Ge=({role:K})=>{var te,le,re,ne,ie,de,ce,oe;Re();const[N,be]=d.useState("new"),[w,U]=d.useState(1),[t,D]=d.useState(null),[y,R]=d.useState(""),[j,W]=d.useState(!1),[Ne,G]=d.useState(!1),[X,Y]=d.useState(null),[q,J]=d.useState(!1),[g,Z]=d.useState(!1),[h,S]=d.useState(new Set),[fe,T]=d.useState(!1),[m,z]=d.useState(null),[C,k]=d.useState({}),[b,M]=d.useState({courier_name:"",tracking_id:"",transport_charges:"",delivery_date:"",receipt:null}),{data:u,isLoading:I,isError:ye,refetch:O}=qe({status:N,page:w}),[ve]=Te(),[_e]=ze(),[we]=Me(),L=[{id:"new",label:"New Orders"},{id:"accepted",label:"Accepted Orders"},{id:"dispatched",label:"Dispatched Orders"},{id:"delivered",label:"Delivered Orders"},{id:"rejected",label:"Rejected Orders"},{id:"cancelled",label:"Cancelled Orders"}];d.useEffect(()=>{if(g){const s=setTimeout(()=>{Z(!1)},500);return()=>clearTimeout(s)}},[u,g]),d.useEffect(()=>{if(m){const s={};m.items.forEach((a,l)=>{s[l]={batch_number:a.batch_number||"",manufacture_date:a.manufacture_date||"",expiry_date:a.expiry_date||""}}),k(s)}},[m]);const De=async()=>{J(!0);try{await O(),p.success("Orders refreshed")}catch{p.error("Failed to refresh orders")}finally{J(!1)}},B=s=>{const a=l=>String(l).padStart(2,"0");return`${s.getFullYear()}-${a(s.getMonth()+1)}-${a(s.getDate())}`},$=new Date,ee=new Date($);ee.setDate($.getDate()-6);const Se=B(ee),Ce=B($),se=s=>{Z(!0),be(s),U(1)},ae=async(s,a)=>{var l;if(a!=="dispatched"){if(!y&&["rejected","cancelled"].includes(a)){p.error("Please enter a note for this action");return}S(r=>new Set(r).add(s));try{await ve({orderId:s,status:a,note:y}).unwrap(),p.success(`Order ${a} successfully`),D(null),R(""),O()}catch(r){p.error(((l=r.data)==null?void 0:l.message)||"Something Went Wrong")}finally{S(r=>{const n=new Set(r);return n.delete(s),n})}}},ke=async s=>{var x;const{courier_name:a,tracking_id:l,transport_charges:r,delivery_date:n,receipt:i}=b;if(!a||!l||!r||!n){p.error("Please fill all required fields");return}S(o=>new Set(o).add(s)),W(!0);try{const o=new FormData;o.append("courier_name",a),o.append("tracking_id",l),o.append("transport_charges",r),o.append("delivery_date",n),y&&o.append("note",y),i&&o.append("receipt",i),await _e({orderId:s,data:o}).unwrap(),p.success("Order dispatched successfully"),D(null),M({courier_name:"",tracking_id:"",transport_charges:"",delivery_date:"",receipt:null}),R(""),O()}catch(o){p.error(((x=o.data)==null?void 0:x.message)||"Failed to dispatch order")}finally{W(!1),S(o=>{const f=new Set(o);return f.delete(s),f})}},Oe=async s=>{var r;const a=[];let l=!0;if(Object.keys(C).forEach(n=>{const i=C[n];if(!i.batch_number||!i.manufacture_date||!i.expiry_date){l=!1,p.error(`Please fill all batch details for item ${parseInt(n)+1}`);return}a.push({item_id:m.items[n].id,batch_number:i.batch_number,manufacture_date:i.manufacture_date,expiry_date:i.expiry_date})}),!!l){S(n=>new Set(n).add(s));try{await we({orderId:s,items:a}).unwrap(),p.success("Batch details updated successfully"),T(!1),z(null),k({}),O()}catch(n){p.error(((r=n.data)==null?void 0:r.message)||"Failed to update batch details")}finally{S(n=>{const i=new Set(n);return i.delete(s),i})}}},V=(s,a,l)=>{k(r=>({...r,[s]:{...r[s],[a]:l}}))},Fe=s=>{z(s),T(!0)},Q=s=>new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),v=s=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(s),F=s=>{const{name:a,value:l,files:r}=s.target;M(n=>({...n,[a]:r?r[0]:l}))},Ae=()=>b.courier_name&&b.tracking_id&&b.transport_charges&&b.delivery_date,Ee=s=>{Y(s),G(!0)},Pe=s=>{var a,l,r,n,i,x,o,f,A,E,P;return{id:s.id,date:s.created_at,buyer:{id:((a=s.buyer)==null?void 0:a.id)||"N/A",name:((l=s.buyer)==null?void 0:l.username)||"N/A",email:((r=s.buyer)==null?void 0:r.email)||"N/A",address:((n=s.buyer)==null?void 0:n.address)||{},phone:((i=s.buyer)==null?void 0:i.phone)||"N/A",whatsapp:((x=s.buyer)==null?void 0:x.whatsapp_number)||"N/A"},seller:{id:((o=s.seller)==null?void 0:o.id)||"N/A",name:((f=s.seller)==null?void 0:f.username)||"N/A",email:((A=s.seller)==null?void 0:A.email)||"N/A",roleId:((E=s.seller)==null?void 0:E.role_based_id)||"N/A",phone:((P=s.seller)==null?void 0:P.phone)||"N/A"},items:s.items.map(c=>{var _,me,he,xe;return{id:c.id,productId:(_=c.product)==null?void 0:_.id,productName:(me=c.product)==null?void 0:me.name,size:(he=c.variant)==null?void 0:he.name,sku:(xe=c.variant)==null?void 0:xe.sku,quantity:c.quantity,price:c.unit_price,discount:c.discount||"0",gst_percentage:c.gst_percentage,total:c.final_price,batch_number:c.batch_number,manufacture_date:c.manufacture_date,expiry_date:c.expiry_date,bulk_price_applied:c.bulk_price_applied,discount_percentage:c.discount_percentage,single_quantity_after_gst_and_discount_price:c.single_quantity_after_gst_and_discount_price}}),totalAmount:s.total_price,subtotal:s.subtotal||s.total_price,gstAmount:s.gst_amount||"0.00",discountAmount:s.discount_amount||"0.00",status:s.status,statusDisplay:s.status_display,paymentStatus:s.payment_status,paymentStatusDisplay:s.payment_status_display,description:s.description||"Order placed",courier_name:s.courier_name,tracking_number:s.tracking_number,transport_charges:s.transport_charges||"0.00",expected_delivery_date:s.expected_delivery_date,receipt:s.receipt,note:s.note||""}};return e.jsxs("div",{className:" py-4 max-w-8xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-extrabold text-gray-800",children:"Orders Management"}),e.jsx("p",{className:"text-sm text-gray-500 font-bold",children:"Manage your orders"})]}),e.jsx("button",{className:"btn btn-ghost gap-2",onClick:De,disabled:I||q,children:q?e.jsxs(e.Fragment,{children:[e.jsx(ue,{className:"animate-spin"}),"Refreshing..."]}):I?"Loading...":e.jsxs(e.Fragment,{children:[e.jsx(ue,{}),"Refresh"]})})]}),e.jsx("div",{className:"md:hidden mb-4",children:e.jsx("select",{className:"select select-bordered w-full",value:N,onChange:s=>se(s.target.value),disabled:g,children:L.map(s=>e.jsx("option",{value:s.id,children:s.label},s.id))})}),e.jsx("div",{className:"hidden md:flex border-b border-gray-200 mb-6 overflow-x-auto",children:L.map(s=>e.jsxs("button",{className:`px-4 py-2 font-medium cursor-pointer text-sm whitespace-nowrap flex items-center ${N===s.id?"border-b-2 border-primary text-primary":"text-gray-500 hover:text-gray-700"}`,onClick:()=>se(s.id),disabled:g,children:[g&&N===s.id&&e.jsx("span",{className:"loading loading-spinner loading-xs mr-2"}),s.label]},s.id))}),g&&e.jsx("div",{className:"absolute inset-0 bg-white bg-opacity-70 flex items-center justify-center z-10 rounded-lg",children:e.jsx("span",{className:"loading loading-spinner loading-lg text-primary"})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden relative",children:e.jsx(d.Suspense,{fallback:e.jsx("div",{className:"flex justify-center items-center p-8",children:e.jsx(ge,{})}),children:I||g?e.jsx("div",{className:"flex justify-center items-center p-8",children:e.jsx(ge,{})}):ye?e.jsxs("div",{className:"text-center py-8",children:[e.jsx($e,{message:"Failed to load vendor orders"}),e.jsx("button",{className:"btn btn-sm btn-outline mt-4",onClick:O,disabled:q,children:q?"Retrying...":"Retry"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"w-12",children:"#"}),e.jsx("th",{children:"Order ID"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Reseller Details"}),e.jsx("th",{children:"Product Info"}),e.jsx("th",{children:"Total Qty"}),e.jsx("th",{children:"Total"}),e.jsx("th",{children:"Status"}),e.jsx("th",{className:"text-center",children:"Actions"})]})}),e.jsx("tbody",{children:((te=u==null?void 0:u.results)==null?void 0:te.length)>0?u.results.map((s,a)=>{var l,r,n,i,x,o,f,A,E,P;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"font-medium",children:a+1+(w-1)*10}),e.jsxs("td",{className:"font-medium",children:["#",s.id]}),e.jsx("td",{className:"font-medium",children:Q(s.created_at)}),e.jsx("td",{className:"font-medium",children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:(l=s.buyer)==null?void 0:l.username}),e.jsx("div",{className:"text-xs text-gray-500",children:(r=s.buyer)==null?void 0:r.email})]})})}),e.jsx("td",{className:"font-medium",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{children:(i=(n=s.items[0])==null?void 0:n.product)==null?void 0:i.name}),e.jsxs("div",{className:"text-xs space-y-1",children:[e.jsxs("div",{children:["SKU: ",(o=(x=s.items[0])==null?void 0:x.product)==null?void 0:o.sku]}),e.jsxs("div",{children:["Category: ",(A=(f=s.items[0])==null?void 0:f.product)==null?void 0:A.category_name]}),e.jsxs("div",{children:["Brand: ",(P=(E=s.items[0])==null?void 0:E.product)==null?void 0:P.brand_name]}),e.jsxs("div",{children:["Sizes: ",s.items.map(c=>{var _;return(_=c.variant)==null?void 0:_.name}).join(", ")]})]})]})}),e.jsx("td",{className:"text-center font-medium",children:s.items.reduce((c,_)=>c+_.quantity,0)}),e.jsx("td",{className:"font-medium",children:v(s.total_price)}),e.jsx("td",{className:"font-medium",children:e.jsx("span",{className:`badge badge-sm font-bold whitespace-nowrap ${s.status==="delivered"?"badge-success":s.status==="rejected"||s.status==="cancelled"?"badge-error":s.status==="accepted"?"badge-primary":s.status==="dispatched"?"badge-secondary":"badge-warning"}`,children:s.status_display})}),e.jsx("td",{children:e.jsxs("div",{className:"flex justify-center gap-2",children:[N==="new"&&e.jsx(e.Fragment,{children:e.jsxs("button",{className:"btn btn-xs btn-success gap-1 font-bold",onClick:()=>ae(s.id,"accepted"),disabled:h.has(s.id),children:[h.has(s.id)?e.jsx("span",{className:"loading loading-spinner loading-xs"}):e.jsx(Be,{size:14}),"Accept"]})}),N==="accepted"&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:"btn btn-xs btn-info gap-1 font-bold animate-bounce",onClick:()=>Fe(s),disabled:h.has(s.id),children:[e.jsx(Ue,{size:14}),"Enter Batch Details"]}),e.jsxs("button",{className:"btn btn-xs btn-primary gap-1 font-bold",onClick:()=>D(s),disabled:h.has(s.id),children:[e.jsx(Ie,{size:14}),"Dispatch"]})]}),e.jsxs("button",{className:"btn btn-xs btn-ghost hover:bg-blue-50 gap-1 font-bold cursor-pointer",onClick:()=>Ee(s),disabled:h.has(s.id),children:[e.jsx(Le,{className:"text-blue-600 font-bold",size:14}),"View Details"]})]})})]},s.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:"10",className:"text-center py-8",children:e.jsxs("div",{className:"flex flex-col items-center justify-center gap-2",children:[e.jsx("svg",{className:"w-16 h-16 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1",d:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-700",children:"No orders found"}),e.jsx("p",{className:"text-gray-500",children:N==="new"?"No new orders available":`No ${(le=L.find(s=>s.id===N))==null?void 0:le.label.toLowerCase()} available`})]})})})})]})}),(u==null?void 0:u.count)>0&&e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center p-4 border-t border-gray-100 gap-4",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["Showing ",e.jsx("span",{className:"font-medium",children:(w-1)*10+1})," to"," ",e.jsx("span",{className:"font-medium",children:(w-1)*10+(((re=u.results)==null?void 0:re.length)||0)})," of"," ",e.jsx("span",{className:"font-medium",children:u.count})," entries"]}),e.jsxs("div",{className:"join",children:[e.jsx("button",{className:"join-item btn btn-sm",disabled:w===1||!u.previous||g,onClick:()=>U(s=>Math.max(1,s-1)),children:"«"}),e.jsx("button",{className:"join-item btn btn-sm btn-active",children:w}),e.jsx("button",{className:"join-item btn btn-sm",disabled:!u.next||g,onClick:()=>U(s=>s+1),children:"»"})]})]})]})})}),t&&e.jsx(je,{children:e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:t.status==="new"?"Reject Order":t.status==="accepted"?"Dispatch Order":"Order Details"}),e.jsx("button",{onClick:()=>{D(null),M({courier_name:"",tracking_id:"",transport_charges:"",delivery_date:"",receipt:null})},className:"btn btn-sm btn-circle btn-ghost",disabled:j,children:e.jsx(pe,{size:20})})]}),t.status==="accepted"?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"font-bold text-lg mb-3 text-gray-700",children:"Order Summary"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Order ID"}),e.jsxs("p",{className:"font-medium",children:["#",t.id]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Order Date"}),e.jsx("p",{className:"font-medium",children:Q(t.created_at)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Total Amount"}),e.jsx("p",{className:"font-medium",children:v(t.total_price)})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"font-bold text-lg mb-3 text-gray-700",children:"Products"}),e.jsx("div",{className:"space-y-4",children:t.items.map((s,a)=>{var l;return e.jsx("div",{className:"flex items-start gap-4 p-2 bg-white rounded border border-gray-100",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium",children:s.product.name}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-2 mt-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"SKU"}),e.jsx("p",{children:s.product.sku||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Size"}),e.jsx("p",{children:((l=s.variant)==null?void 0:l.name)||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Base Price"}),e.jsx("p",{children:s.unit_price})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Quantity"}),e.jsx("p",{children:s.quantity})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Total Price"}),e.jsx("p",{children:v(s.final_price)})]})]})]})},a)})})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"font-bold text-lg mb-3 text-gray-700",children:"Customer Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium mb-2 text-gray-600",children:"Contact Details"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Name: "}),((ne=t.buyer)==null?void 0:ne.username)||"N/A"]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Email: "}),((ie=t.buyer)==null?void 0:ie.email)||"N/A"]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Phone: "}),((de=t.buyer)==null?void 0:de.phone)||"N/A"]})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium mb-2 text-gray-600",children:"Shipping Address"}),(ce=t.buyer)!=null&&ce.address?e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{children:t.buyer.address.street_address||"N/A"}),e.jsxs("p",{children:[t.buyer.address.city,",",t.buyer.address.district&&` ${t.buyer.address.district},`,t.buyer.address.state&&` ${t.buyer.address.state},`]}),e.jsxs("p",{children:[t.buyer.address.postal_code&&`${t.buyer.address.postal_code},`,t.buyer.address.country]})]}):e.jsx("p",{className:"text-gray-500",children:"No address provided"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"font-bold text-lg mb-3 text-gray-700",children:"Dispatch Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsxs("span",{className:"label-text font-medium",children:["Courier Name ",e.jsx("span",{className:"text-red-500",children:"*"})]})}),e.jsx("input",{type:"text",name:"courier_name",value:b.courier_name,onChange:F,className:"input input-bordered w-full",placeholder:"e.g. FedEx, UPS, DHL",required:!0,disabled:j})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsxs("span",{className:"label-text font-medium",children:["Tracking ID ",e.jsx("span",{className:"text-red-500",children:"*"})]})}),e.jsx("input",{type:"text",name:"tracking_id",value:b.tracking_id,onChange:F,className:"input input-bordered w-full",placeholder:"Enter tracking number",required:!0,disabled:j})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsxs("span",{className:"label-text font-medium",children:["Shipping Cost ",e.jsx("span",{className:"text-red-500",children:"*"})]})}),e.jsx("input",{type:"number",name:"transport_charges",value:b.transport_charges,onChange:F,className:"input input-bordered w-full",placeholder:"Enter shipping cost",min:"0",step:"0.01",required:!0,disabled:j})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsxs("span",{className:"label-text font-medium",children:["Delivery Date ",e.jsx("span",{className:"text-red-500",children:"*"})]})}),e.jsx("input",{type:"date",name:"delivery_date",value:b.delivery_date,onChange:F,className:"input input-bordered w-full",required:!0,min:Se,max:Ce,disabled:j})]}),e.jsxs("div",{className:"form-control md:col-span-2",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text font-medium",children:"Shipping Receipt (Optional)"})}),e.jsx("input",{type:"file",name:"receipt",onChange:F,className:"file-input file-input-bordered w-full",accept:".pdf,.jpg,.jpeg,.png",disabled:j}),e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text-alt",children:"Upload receipt or proof of shipment"})})]}),e.jsxs("div",{className:"form-control md:col-span-2",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text font-medium",children:"Notes"})}),e.jsx("textarea",{className:"textarea textarea-bordered h-24",placeholder:"Enter any additional notes for this dispatch...",value:y,onChange:s=>R(s.target.value),disabled:j})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx("button",{onClick:()=>{D(null),M({courier_name:"",tracking_id:"",transport_charges:"",delivery_date:"",receipt:null})},className:"btn btn-ghost",disabled:j,children:"Cancel"}),e.jsx("button",{onClick:()=>ke(t.id),className:"btn btn-primary",disabled:!Ae()||j,children:j?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"loading loading-spinner"}),"Dispatching..."]}):"Confirm Dispatch"})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsxs("h4",{className:"font-bold text-lg mb-2 text-gray-700",children:["Order #",t.id]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Order Date"}),e.jsx("p",{className:"font-medium",children:Q(t.created_at)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Status"}),e.jsx("p",{className:"font-medium capitalize",children:t.status_display})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"font-bold text-lg mb-2 text-gray-700",children:"Products"}),e.jsx("div",{className:"space-y-3",children:t.items.map((s,a)=>e.jsx("div",{className:"flex items-start gap-4 p-3 bg-white rounded border border-gray-100",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium",children:s.product.name}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 mt-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Quantity"}),e.jsx("p",{children:s.quantity})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Price"}),e.jsx("p",{children:v(s.unit_price)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Total"}),e.jsx("p",{children:v(s.unit_price*s.quantity)})]})]})]})},a))})]}),(t.status==="new"||t.status==="accepted")&&e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsxs("span",{className:"label-text font-medium",children:[t.status==="new"?"Reason for Rejection":"Dispatch Notes",e.jsx("span",{className:"text-red-500",children:"*"})]})}),e.jsx("textarea",{className:"textarea textarea-bordered h-24",placeholder:t.status==="new"?"Please provide reason for rejecting this order...":"Enter any notes about this dispatch...",value:y,onChange:s=>R(s.target.value),required:!0,disabled:h.has(t.id)})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx("button",{onClick:()=>D(null),className:"btn btn-ghost",disabled:h.has(t.id),children:"Cancel"}),t.status==="new"&&e.jsx("button",{onClick:()=>ae(t.id,"rejected"),className:"btn btn-error",disabled:!y||h.has(t.id),children:h.has(t.id)?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"loading loading-spinner loading-xs"}),"Processing..."]}):"Confirm Rejection"})]})]})]})})}),fe&&m&&e.jsx(je,{children:e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Manage Batch Details"}),e.jsx("button",{onClick:()=>{T(!1),z(null),k({})},className:"btn btn-sm btn-circle btn-ghost",disabled:h.has(m.id),children:e.jsx(pe,{size:20})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsxs("h4",{className:"font-bold text-lg mb-3 text-gray-700",children:["Order #",m.id]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Customer"}),e.jsx("p",{className:"font-medium",children:(oe=m.buyer)==null?void 0:oe.username})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Total Items"}),e.jsx("p",{className:"font-medium",children:m.items.length})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-bold text-lg text-gray-700",children:"Product Batch Details"}),m.items.map((s,a)=>{var l,r,n,i;return e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("h5",{className:"font-semibold text-gray-800",children:[s.product.name," - ",(l=s.variant)==null?void 0:l.name]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Quantity"}),e.jsx("p",{children:s.quantity})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"SKU"}),e.jsx("p",{children:s.product.sku})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Price"}),e.jsx("p",{children:v(s.unit_price)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Total"}),e.jsx("p",{children:v(s.final_price||s.unit_price*s.quantity)})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsxs("span",{className:"label-text font-medium",children:["Batch Number ",e.jsx("span",{className:"text-red-500",children:"*"})]})}),e.jsx("input",{type:"text",value:((r=C[a])==null?void 0:r.batch_number)||"",onChange:x=>V(a,"batch_number",x.target.value),className:"input input-bordered w-full",placeholder:"Enter batch number",required:!0,disabled:h.has(m.id)})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsxs("span",{className:"label-text font-medium",children:["Manufacture Date ",e.jsx("span",{className:"text-red-500",children:"*"})]})}),e.jsx("input",{type:"date",value:((n=C[a])==null?void 0:n.manufacture_date)||"",onChange:x=>V(a,"manufacture_date",x.target.value),className:"input input-bordered w-full",required:!0,max:B(new Date),disabled:h.has(m.id)})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsxs("span",{className:"label-text font-medium",children:["Expiry Date ",e.jsx("span",{className:"text-red-500",children:"*"})]})}),e.jsx("input",{type:"date",value:((i=C[a])==null?void 0:i.expiry_date)||"",onChange:x=>V(a,"expiry_date",x.target.value),className:"input input-bordered w-full",required:!0,min:B(new Date),disabled:h.has(m.id)})]})]})]},a)})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx("button",{onClick:()=>{T(!1),z(null),k({})},className:"btn btn-ghost",disabled:h.has(m.id),children:"Cancel"}),e.jsx("button",{onClick:()=>Oe(m.id),className:"btn btn-primary",disabled:h.has(m.id),children:h.has(m.id)?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"loading loading-spinner"}),"Updating..."]}):"Update Batch Details"})]})]})]})})}),Ne&&X&&e.jsx(d.Suspense,{fallback:e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-white rounded-lg p-6",children:e.jsx("span",{className:"loading loading-spinner loading-lg"})})}),children:e.jsx(Ve,{order:Pe(X),onClose:()=>{G(!1),Y(null)}})})]})};export{Ge as default};
