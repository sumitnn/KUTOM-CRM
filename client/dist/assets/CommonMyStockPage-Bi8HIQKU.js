const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-oHO_bMXB.js","assets/index-CdwHP-N2.css","assets/ErrorMessage-C1rBwS37.js"])))=>i.map(i=>d[i]);
import{af as W,r,ag as J,ah as K,j as e,y as D,_ as H}from"./index-oHO_bMXB.js";import{F as Y,t as b,r as C,b as E,f as u,g as L,i as Z,P as ee}from"./index-DCVWk_eg.js";import{M as te}from"./ModalPortal-CaX2GLzp.js";import"./index-DsfZBStp.js";function M(d){return W({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",strokeWidth:"2",d:"M1,12 C1,18.075 5.925,23 12,23 C18.075,23 23,18.075 23,12 C23,5.925 18.075,1 12,1 C7.563,1 4,4 2,7.5 M1,1 L1,8 L8,8 M16,17 L12,13 L12,6"},child:[]}]})(d)}const $=r.lazy(()=>H(()=>import("./index-oHO_bMXB.js").then(d=>d.cH),__vite__mapDeps([0,1]))),A=r.lazy(()=>H(()=>import("./ErrorMessage-C1rBwS37.js"),__vite__mapDeps([2,0,1]))),ce=({role:d})=>{const[o,I]=r.useState("in_stock"),[c,g]=r.useState(1),i=10,[x,j]=r.useState(!1),[n,f]=r.useState(null),[se,N]=r.useState(null),{data:l={},isLoading:m,isError:P,error:p,refetch:R}=J({status:o,page:c,pageSize:i}),{data:v,isLoading:T,isError:F,refetch:w}=K(n==null?void 0:n.id,{skip:!n||!x}),y=Array.isArray(l)?l:l.results||l.data||[],h=Array.isArray(l)?l.length:l.count||l.total||0;r.useEffect(()=>{x&&n&&w()},[x,n,w]);const q=t=>{I(t),g(1)},B=()=>{R(),D.success("Stock data refreshed!")},O=t=>{f(t),j(!0)},_=()=>{j(!1),f(null)},Q=(t,s)=>{navigator.clipboard.writeText(t),N(s),D.success("Batch number copied to clipboard!"),setTimeout(()=>N(null),2e3)},k=t=>t.total_quantity===0?e.jsxs("span",{className:"badge badge-error gap-1",children:[e.jsx(E,{className:"w-3 h-3"})," Out of Stock"]}):t.total_quantity<10?e.jsxs("span",{className:"badge badge-warning gap-1",children:[e.jsx(b,{className:"w-3 h-3"})," Low Stock"]}):e.jsxs("span",{className:"badge badge-success gap-1",children:[e.jsx(C,{className:"w-3 h-3"})," In Stock"]}),S=t=>t===0?"text-error font-bold":t<10?"text-warning font-bold":"text-success font-bold",V=()=>e.jsxs("tr",{className:"bg-gradient-to-r from-gray-50 to-gray-100",children:[e.jsx("th",{className:"w-12 text-left py-4 px-4 font-bold text-gray-700",children:"#"}),e.jsx("th",{className:"text-left py-4 px-4 font-bold text-gray-700",children:"Product Information"}),e.jsx("th",{className:"text-left py-4 px-4 font-bold text-gray-700",children:"Batch Details"}),e.jsx("th",{className:"text-center py-4 px-4 font-bold text-gray-700",children:"Quantity"}),e.jsx("th",{className:"text-center py-4 px-4 font-bold text-gray-700",children:"Status"}),e.jsx("th",{className:"text-center py-4 px-4 font-bold text-gray-700",children:"Last Updated"}),e.jsx("th",{className:"text-center py-4 px-4 font-bold text-gray-700",children:"Actions"})]}),G=(t,s)=>{`${t.product_name}`,t.variant_name&&t.variant_name!=="Default"&&`${t.variant_name}`;const a=`${t.brand_name} • ${t.category_name}${t.subcategory_name&&t.subcategory_name!=="N/A"?` • ${t.subcategory_name}`:""}`;return e.jsxs("tr",{className:"border-b border-gray-100 hover:bg-blue-50 transition-colors duration-200",children:[e.jsx("td",{className:"py-4 px-4 font-semibold text-gray-600",children:(c-1)*i+s+1}),e.jsx("td",{className:"py-4 px-4",children:e.jsx("div",{className:"flex flex-col space-y-2",children:e.jsxs("div",{className:"flex items-start space-x-2 group cursor-pointer",children:[e.jsx(Z,{className:"w-4 h-4 text-gray-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-semibold text-gray-800 group-hover:text-blue-600 transition-colors truncate",children:t.product_name}),t.variant_name&&t.variant_name!=="Default"&&e.jsxs("p",{className:"text-sm text-gray-600",children:["Variant: ",t.variant_name]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1 truncate",children:a})]})]})})}),e.jsx("td",{className:"py-4 px-4",children:e.jsxs("div",{className:"flex flex-col space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2 group cursor-pointer",onClick:()=>Q(t.batch_number,"batch"),children:[e.jsx(u,{className:"w-4 h-4 text-gray-400 flex-shrink-0"}),e.jsx("span",{className:"font-mono text-gray-700 group-hover:text-blue-600 transition-colors",children:t.batch_number}),e.jsx(ee,{className:"w-3 h-3 text-gray-400 opacity-0 group-hover:opacity-100 transition-opacity flex-shrink-0"})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-gray-600",children:[e.jsx(L,{className:"w-3 h-3 text-gray-400 flex-shrink-0"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("span",{className:"text-xs",children:["MFG: ",new Date(t.manufacture_date).toLocaleDateString()]}),e.jsxs("span",{className:"text-xs",children:["EXP: ",new Date(t.expiry_date).toLocaleDateString()]})]})]})]})}),e.jsx("td",{className:"py-4 px-4 text-center",children:e.jsx("span",{className:`text-lg font-bold ${S(t.total_quantity)}`,children:t.total_quantity})}),e.jsx("td",{className:"py-4 px-4 text-center",children:k(t)}),e.jsx("td",{className:"py-4 px-4 text-center text-sm text-gray-600",children:new Date(t.updated_at).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}),e.jsx("td",{className:"py-4 px-4 text-center",children:e.jsx("button",{onClick:()=>O(t),className:"btn btn-ghost btn-sm font-semibold text-primary hover:bg-blue-100 hover:text-blue-700 transition-colors tooltip","data-tip":"View Stock History",children:e.jsx(M,{className:"w-4 h-4"})})})]},t.id)},U=()=>{var t;return m?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"text-center py-12",children:e.jsx(r.Suspense,{fallback:e.jsx("div",{children:"Loading..."}),children:e.jsx($,{})})})}):P?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"text-center py-12",children:e.jsx(r.Suspense,{fallback:e.jsx("div",{children:"Error loading..."}),children:e.jsx(A,{message:((t=p==null?void 0:p.data)==null?void 0:t.message)||"Failed to load stocks"})})})}):!y||y.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"text-center py-16",children:e.jsxs("div",{className:"flex flex-col items-center justify-center gap-4 text-gray-500",children:[e.jsx(b,{className:"w-16 h-16 text-gray-300"}),e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-600 mb-2",children:o==="in_stock"?"No items in stock":o==="out_of_stock"?"No out of stock items":"No new stock items today"}),e.jsx("p",{className:"text-gray-500 max-w-sm mx-auto",children:o==="in_stock"?"Items that are currently in stock will appear here":o==="out_of_stock"?"Items that are out of stock will appear here":"New stock items added today will appear here"})]})]})})}):y.map((s,a)=>G(s,a))},z=()=>{if(!n||!x)return null;const t=Array.isArray(v)?v:[],s=n;return e.jsx(te,{children:e.jsx("div",{className:"modal modal-open",children:e.jsxs("div",{className:"modal-box max-w-6xl p-0 overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("h3",{className:"font-bold text-xl text-gray-800 mb-2",children:["Stock History - ",s.product_name,s.variant_name&&s.variant_name!=="Default"&&e.jsxs("span",{className:"text-gray-600",children:[" (",s.variant_name,")"]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{className:"w-4 h-4"}),e.jsx("span",{className:"font-mono",children:s.batch_number})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{className:"w-4 h-4"}),e.jsxs("span",{children:["Expires: ",new Date(s.expiry_date).toLocaleDateString()]})]}),e.jsxs("div",{className:`text-lg font-bold ${S(s.total_quantity)}`,children:["Current: ",s.total_quantity," units"]})]})]}),e.jsx("button",{onClick:_,className:"btn btn-ghost btn-sm btn-circle text-gray-500 hover:text-gray-700 hover:bg-white",children:"✕"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 p-6 bg-white border-b border-gray-100",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide",children:"Product"}),e.jsx("p",{className:"text-sm font-medium text-gray-800",children:s.product_name}),s.variant_name&&s.variant_name!=="Default"&&e.jsxs("p",{className:"text-xs text-gray-600",children:["Variant: ",s.variant_name]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide",children:"Brand & Category"}),e.jsxs("p",{className:"text-sm text-gray-800",children:[s.brand_name," • ",s.category_name]}),s.subcategory_name&&s.subcategory_name!=="N/A"&&e.jsx("p",{className:"text-xs text-gray-600",children:s.subcategory_name})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide",children:"Batch Information"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"font-mono text-sm text-gray-800",children:s.batch_number})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide",children:"Manufactured"}),e.jsx("p",{className:"text-sm text-gray-800",children:new Date(s.manufacture_date).toLocaleDateString()})]})]}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide",children:"Dates"}),e.jsxs("p",{className:"text-sm text-gray-800",children:["Created: ",new Date(s.created_at).toLocaleDateString()]}),e.jsxs("p",{className:"text-sm text-gray-800",children:["Updated: ",new Date(s.updated_at).toLocaleDateString()]})]})}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide",children:"Expiry & Status"}),e.jsxs("p",{className:"text-sm text-gray-800",children:["Expires: ",new Date(s.expiry_date).toLocaleDateString()]}),e.jsx("div",{className:"mt-1",children:k(s)})]})})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("h4",{className:"font-semibold text-gray-800 mb-4",children:"Stock Movement History"}),e.jsx("div",{className:"overflow-x-auto rounded-lg border border-gray-200",children:T?e.jsx("div",{className:"text-center py-12",children:e.jsx(r.Suspense,{fallback:e.jsx("div",{children:"Loading..."}),children:e.jsx($,{})})}):F?e.jsx("div",{className:"text-center py-12",children:e.jsx(r.Suspense,{fallback:e.jsx("div",{children:"Error loading..."}),children:e.jsx(A,{message:"Failed to load stock history"})})}):e.jsxs("table",{className:"table table-auto w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"Date & Time"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"Action"}),e.jsx("th",{className:"text-center py-3 px-4 font-semibold text-gray-700",children:"Previous Qty"}),e.jsx("th",{className:"text-center py-3 px-4 font-semibold text-gray-700",children:"Change"}),e.jsx("th",{className:"text-center py-3 px-4 font-semibold text-gray-700",children:"New Qty"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:t.length>0?t.map((a,X)=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"py-3 px-4 text-sm text-gray-600",children:new Date(a.created_at).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:`badge badge-sm font-semibold ${a.action==="ADD"?"badge-success":a.action==="REMOVE"?"badge-error":a.action==="ORDER"?"badge-warning":a.action==="RETURN"?"badge-info":(a.action==="EXPIRED","badge-neutral")}`,children:a.action})}),e.jsx("td",{className:"py-3 px-4 text-center text-sm font-medium text-gray-700",children:a.old_quantity}),e.jsxs("td",{className:`py-3 px-4 text-center text-sm font-bold ${a.change_quantity>0?"text-success":"text-error"}`,children:[a.change_quantity>0?"+":"",a.change_quantity]}),e.jsx("td",{className:"py-3 px-4 text-center text-sm font-bold text-gray-800",children:a.new_quantity})]},X)):e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"text-center py-12 text-gray-500",children:e.jsxs("div",{className:"flex flex-col items-center justify-center gap-3",children:[e.jsx(M,{className:"w-12 h-12 text-gray-300"}),e.jsx("h4",{className:"font-medium text-gray-600",children:"No history available"}),e.jsx("p",{className:"text-sm",children:"No stock history records found for this item."})]})})})})]})})]}),e.jsx("div",{className:"modal-action p-6 bg-gray-50 border-t border-gray-200",children:e.jsx("button",{onClick:_,className:"btn btn-ghost hover:bg-white",children:"Close"})})]})})})};return e.jsx("div",{className:"min-h-screen  py-4",children:e.jsxs("div",{className:"max-w-8xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center mb-8 gap-6",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Stock Inventory Management"}),e.jsx("p",{className:"text-gray-600 max-w-2xl",children:"Manage your stock inventory, track product movements, and monitor batch details in real-time."})]}),e.jsx("div",{className:"flex gap-3",children:e.jsxs("button",{onClick:B,className:"btn btn-primary gap-2 shadow-lg hover:shadow-xl transition-all duration-200",disabled:m,children:[e.jsx(Y,{className:`w-4 h-4 ${m?"animate-spin":""}`}),m?"Refreshing...":"Refresh Data"]})})]}),e.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 p-2 mb-8",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:[{key:"new_stock",label:"New Today",icon:b,color:"blue"},{key:"in_stock",label:"In Stock",icon:C,color:"green"},{key:"out_of_stock",label:"Out of Stock",icon:E,color:"red"}].map(t=>{const s=t.icon;return e.jsxs("button",{className:`flex cursor-pointer items-center gap-2 px-6 py-3 rounded-xl font-semibold transition-all duration-200 ${o===t.key?`bg-${t.color}-50 text-${t.color}-700 border border-${t.color}-200 shadow-sm`:"text-gray-600 hover:text-gray-800 hover:bg-gray-50"}`,onClick:()=>q(t.key),children:[e.jsx(s,{className:"w-4 h-4"}),t.label]},t.key)})})}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table w-full",children:[e.jsx("thead",{children:V()}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:U()})]})}),h>i&&e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center p-6 border-t border-gray-200 gap-4 bg-gray-50",children:[e.jsxs("div",{className:"text-sm text-gray-600 font-medium",children:["Showing ",e.jsx("span",{className:"font-semibold text-gray-800",children:(c-1)*i+1})," to"," ",e.jsx("span",{className:"font-semibold text-gray-800",children:Math.min(c*i,h)})," of"," ",e.jsx("span",{className:"font-semibold text-gray-800",children:h})," entries"]}),e.jsxs("div",{className:"join shadow-sm",children:[e.jsx("button",{className:"join-item btn btn-sm border-gray-300 bg-white hover:bg-gray-50 text-gray-700 font-medium",disabled:c===1,onClick:()=>g(t=>Math.max(1,t-1)),children:"« Previous"}),e.jsxs("button",{className:"join-item btn btn-sm bg-blue-500 text-white border-blue-500 font-medium",children:["Page ",c]}),e.jsx("button",{className:"join-item btn btn-sm border-gray-300 bg-white hover:bg-gray-50 text-gray-700 font-medium",disabled:c*i>=h,onClick:()=>g(t=>t+1),children:"Next »"})]})]})]}),z()]})})};export{ce as default};
