const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/LazyImage-0RPFLAb2.js","assets/index-0HRytCPr.js","assets/index-DfS9FcIS.css"])))=>i.map(i=>d[i]);
import{u as U,a as X,Z as O,bP as Z,cc as J,cd as K,j as e,bQ as q,r as L,L as B,_ as ee,bR as te,y as x,bS as se}from"./index-0HRytCPr.js";import{s as T,d as $,_ as M,$ as re,X as ae,v,z as ie}from"./index--WZidvUd.js";import{T as le}from"./index-J5dHqBTN.js";import{c as ne}from"./index-DU0ZzBer.js";const oe=L.lazy(()=>ee(()=>import("./LazyImage-0RPFLAb2.js"),__vite__mapDeps([0,1,2]))),ce=(t,l)=>{if(!t||t.length===0)return 0;const o=t[0];switch(l){case"stockist":return parseFloat(o.stockist_actual_price||o.actual_price);case"reseller":return parseFloat(o.reseller_actual_price||o.actual_price);default:return parseFloat(o.actual_price)}},de=(t,l)=>{if(!t||t.length===0)return 0;const o=t[0];return l==="stockist"?o.stockist_discount:l==="reseller"?o.reseller_discount:0},ue=(t,l)=>{if(!t||t.length===0)return 0;const o=t[0];return l==="stockist"?o.stockist_gst:l==="reseller"?o.reseller_gst:o.gst_percentage},A=(t,l)=>{if(!t||t.length===0)return{basePrice:0,discountPercentage:0,discountAmount:0,priceAfterDiscount:0,gstPercentage:0,gstAmount:0,finalPrice:0};const o=ce(t,l),n=de(t,l),p=ue(t,l),b=o*n/100,h=o-b,j=h*p/100,w=h+j;return{basePrice:o,discountPercentage:n,discountAmount:b,priceAfterDiscount:h,gstPercentage:p,gstAmount:j,finalPrice:w}},G=(t,l,o)=>{if(!t||t.length===0)return{totalBase:0,totalDiscount:0,totalPriceAfterDiscount:0,totalGst:0,totalFinal:0};const n=A(t,o);return{totalBase:n.basePrice*l,totalDiscount:n.discountAmount*l,totalPriceAfterDiscount:n.priceAfterDiscount*l,totalGst:n.gstAmount*l,totalFinal:n.finalPrice*l}},he=({role:t})=>{const l=U(),o=X(),n=O(i=>i.cart.items),p=O(i=>i.auth.user),[b,{isLoading:h}]=Z(),[j,{isLoading:w}]=J(),[z,{isLoading:I}]=K(),k=h||w||I,u=n.reduce((i,d)=>{var a;const s=(a=d.variant)==null?void 0:a.product_variant_prices;if(!s||s.length===0)return i;const r=G(s,d.quantity,t);return{subtotal:i.subtotal+r.totalBase,totalDiscount:i.totalDiscount+r.totalDiscount,totalPriceAfterDiscount:i.totalPriceAfterDiscount+r.totalPriceAfterDiscount,totalGst:i.totalGst+r.totalGst,totalFinal:i.totalFinal+r.totalFinal}},{subtotal:0,totalDiscount:0,totalPriceAfterDiscount:0,totalGst:0,totalFinal:0}),F=0,S=u.totalFinal+F,_=i=>{var d,s,r;return(r=(s=(d=i.variant)==null?void 0:d.product_variant_prices)==null?void 0:s[0])!=null&&r.total_available_quantity?Number(i.variant.product_variant_prices[0].total_available_quantity):0},P=(i,d)=>{const s=n.find(a=>a.cartItemId===i);if(!s)return;const r=_(s);if(r===0){x.error("Sorry, This Product is currently out of stock");return}if(d>r){x.error(`Only ${r} units available for ${s.name}`);return}l(se({cartItemId:i,quantity:Math.max(1,d)}))},E=i=>{l(te(i))},W=async()=>{var d,s;if(n.filter(r=>{const a=_(r);return r.quantity>a}).length>0){t==="admin"?x.error("Some items are Out Of Stock. Please contact the vendor to add more stock."):x.error("Some items exceed available quantity. Please adjust quantities.");return}try{if(t==="stockist"||t==="reseller"){const r={note:`Order request from ${p==null?void 0:p.email} (${t})`,items:n.map(a=>{var m;return{product_id:a.product_id,rolebaseid:a.rolebaseid,variant:(m=a.variant)==null?void 0:m.id,quantity:a.quantity}})};t==="stockist"?(await j(r).unwrap(),x.success("Order request submitted successfully! Waiting for admin approval.")):t==="reseller"&&(await z(r).unwrap(),x.success("Order request submitted successfully! Waiting for stockist approval."))}else{const r={items:n.map(a=>{var y,g;const m=(y=a.variant)==null?void 0:y.product_variant_prices,c=m?A(m,t):null;return{product_id:a.product_id,rolebaseid:a.rolebaseid,quantity:a.quantity,variant_id:((g=a.variant)==null?void 0:g.id)||null,unit_price:c?c.finalPrice:a.final_price||0,gst_tax:c?c.gstAmount:a.gst_amount||0,gst_percentage:c?c.gstPercentage:a.gst_percentage||0,discount_amount:c?c.discountAmount:a.discount_amount||0,discount_percentage:c?c.discountPercentage:a.discount_percentage||0}}),subtotal:u.subtotal,shipping:F,gst:u.totalGst,discount:u.totalDiscount,total:S};await b(r).unwrap(),x.success("Order placed successfully!")}l(q())}catch(r){console.error("Checkout error:",r),x.error(((d=r==null?void 0:r.data)==null?void 0:d.message)||((s=r==null?void 0:r.data)==null?void 0:s.error)||"Something went wrong.")}},Y=()=>k?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing..."]}):t==="stockist"?"Submit Order Request to Admin":t==="reseller"?"Submit Order Request to Stockist":"Proceed to Checkout",Q=()=>t==="stockist"?{text:"Stockist Cart",color:"bg-blue-100 text-blue-800 border-blue-200",icon:e.jsx(ie,{className:"mr-1"})}:t==="reseller"?{text:"Reseller Cart",color:"bg-purple-100 text-purple-800 border-purple-200",icon:e.jsx(M,{className:"mr-1"})}:{text:"Shopping Cart",color:"bg-gray-100 text-gray-800 border-gray-200",icon:e.jsx(v,{className:"mr-1"})},H=()=>t==="stockist"||t==="reseller"?e.jsx("div",{className:`${t==="stockist"?"bg-blue-50 border-blue-200":"bg-purple-50 border-purple-200"} border rounded-xl p-4 mb-4`,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{className:`w-5 h-5 ${t==="stockist"?"text-blue-600":"text-purple-600"} mr-2`,fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})}),e.jsx("span",{className:`${t==="stockist"?"text-blue-800":"text-purple-800"} font-medium text-sm`,children:t==="stockist"?"As a stockist, your order will be submitted as a request for admin approval. You'll receive special wholesale pricing.":"As a reseller, your order will be submitted as a request for stockist approval. You'll receive special reseller pricing."})]})}):null,V=()=>e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[60vh] text-center px-4 py-12",children:[e.jsx("div",{className:"w-32 h-32 bg-gradient-to-br from-gray-100 to-gray-200 rounded-full flex items-center justify-center mb-6",children:e.jsx(v,{className:"w-16 h-16 text-gray-400"})}),e.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-3",children:"Your cart is empty"}),e.jsx("p",{className:"text-gray-500 max-w-md mb-8",children:t==="stockist"?"Start adding wholesale products to your cart to place bulk orders.":t==="reseller"?"Start adding products to your cart to place reseller orders.":"Looks like you haven't added any items to your cart yet. Start shopping to discover amazing products!"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs(B,{to:`/${t}/products`,className:"inline-flex items-center px-8 py-3 border border-transparent rounded-lg shadow-sm text-base font-bold text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 cursor-pointer transition-all duration-200 hover:shadow-lg",children:[e.jsx(v,{className:"mr-2"}),t==="stockist"?"Browse Wholesale Products":t==="reseller"?"Browse Reseller Products":"Continue Shopping"]}),e.jsxs("button",{onClick:()=>o(`/${t}/dashboard`),className:"inline-flex items-center px-8 py-3 border border-gray-300 rounded-lg shadow-sm text-base font-bold text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 cursor-pointer transition-all duration-200",children:[e.jsx(T,{className:"mr-2"}),"Go to Dashboard"]})]})]}),D=Q();return e.jsx("div",{className:"min-h-screen py-4",children:e.jsxs("div",{className:"max-w-8xl mx-auto",children:[n.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>o(`/${t}/products`),className:"btn btn-ghost btn-sm mb-4 cursor-pointer hover:bg-gray-100 transition-colors",children:[e.jsx(T,{className:"mr-2"}),"Back to Products"]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-extrabold text-gray-900",children:t==="stockist"?"Stockist Order Cart":t==="reseller"?"Reseller Order Cart":"Your Shopping Cart"}),e.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-bold border ${D.color}`,children:[D.icon,D.text]})]}),e.jsxs("p",{className:"text-gray-500 font-medium",children:[n.length," ",n.length===1?"item":"items"," in your cart"]})]}),e.jsxs("button",{onClick:()=>l(q()),className:"mt-2 sm:mt-0 text-red-500 hover:text-red-700 font-medium text-sm flex items-center cursor-pointer transition-colors",children:[e.jsx($,{className:"mr-1"})," Clear all items"]})]})]}),n.length===0?e.jsx(V,{}):e.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[e.jsxs("div",{className:"lg:w-2/3",children:[e.jsx("div",{className:"bg-white shadow-sm rounded-xl overflow-hidden",children:e.jsxs("div",{className:"divide-y divide-gray-200",children:[H(),n.map(i=>{var R;const d=(R=i.variant)==null?void 0:R.product_variant_prices,s=d?A(d,t):null,r=d?G(d,i.quantity,t):null,{cartItemId:a,name:m,quantity:c,image:y,variant:g}=i,N=_(i),C=c>=N;return e.jsxs("div",{className:"p-4 sm:p-6 flex flex-col sm:flex-row group hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex-shrink-0 relative mb-4 sm:mb-0",children:[e.jsx(L.Suspense,{fallback:e.jsx("div",{className:"w-24 h-24 sm:w-32 sm:h-32 bg-gray-200 rounded-lg animate-pulse"}),children:e.jsx(oe,{src:y||"/placeholder.png",alt:m,className:"w-24 h-24 sm:w-32 sm:h-32 rounded-lg object-cover cursor-pointer",onError:f=>{f.target.src.includes("/placeholder.png")||(f.target.onerror=null,f.target.src="/placeholder.png")}})}),(g==null?void 0:g.name)&&e.jsx("span",{className:"absolute top-1 left-1 sm:top-2 sm:left-2 bg-white/90 text-xs font-bold px-2 py-1 rounded-md shadow-sm cursor-default",children:g.name})]}),e.jsxs("div",{className:"sm:ml-6 flex-grow",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-lg font-extrabold text-gray-900 cursor-pointer hover:text-indigo-600 transition-colors line-clamp-2",children:m}),e.jsxs("div",{className:"mt-1 text-xs text-blue-600 bg-blue-50 px-2 py-1 rounded inline-block",children:["Available: ",N," units"]}),s&&e.jsxs("div",{className:"mt-2 space-y-1",children:[s.discountPercentage>0&&e.jsxs("div",{className:"text-xs text-red-600 bg-red-50 px-2 py-1 rounded inline-block mr-2",children:[e.jsx(M,{className:"inline mr-1"}),s.discountPercentage,"% Role Discount"]}),s.gstPercentage>0&&e.jsxs("div",{className:"text-xs text-blue-600 bg-blue-50 px-2 py-1 rounded inline-block",children:["GST: ",s.gstPercentage,"%"]})]})]}),e.jsx("button",{onClick:()=>E(a),className:"mt-2 sm:mt-0 sm:ml-4 text-gray-400 hover:text-red-500 transition-colors cursor-pointer p-1 self-start sm:self-center",title:"Remove item",children:e.jsx($,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"mt-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("button",{onClick:()=>P(a,c-1),className:`p-2 rounded-lg ${c<=1?"text-gray-300 cursor-not-allowed":"text-gray-600 hover:bg-gray-100 cursor-pointer"} transition-colors`,disabled:c<=1,children:e.jsx(re,{className:"h-4 w-4"})}),e.jsx("input",{type:"number",min:"1",max:N,value:c,onChange:f=>P(a,Math.max(1,Number(f.target.value))),className:"mx-2 w-14 text-center border border-gray-300 rounded-lg py-2 text-sm font-bold focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"}),e.jsx("button",{onClick:()=>P(a,c+1),className:`p-2 rounded-lg ${C?"text-gray-300 cursor-not-allowed":"text-gray-600 hover:bg-gray-100 cursor-pointer"} transition-colors`,disabled:C,title:C?`Maximum ${N} units available`:"",children:e.jsx(ae,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"text-right",children:[s&&e.jsxs("div",{className:"mb-3 p-3 bg-gray-50 rounded-lg border border-gray-200",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-2 font-semibold",children:"Price per unit:"}),e.jsxs("div",{className:"flex justify-between items-center text-sm mb-1",children:[e.jsx("span",{className:"text-gray-500",children:"Base Price:"}),e.jsxs("span",{className:"font-medium",children:["₹",s.basePrice.toFixed(2)]})]}),s.discountPercentage>0&&e.jsxs("div",{className:"flex justify-between items-center text-sm mb-1",children:[e.jsxs("span",{className:"text-red-500",children:["Discount (",s.discountPercentage,"%):"]}),e.jsxs("span",{className:"font-medium text-red-500",children:["-₹",s.discountAmount.toFixed(2)]})]}),s.discountPercentage>0&&e.jsxs("div",{className:"flex justify-between items-center text-sm mb-1 bg-green-50 px-2 py-1 rounded",children:[e.jsx("span",{className:"text-green-600 font-medium",children:"After Discount:"}),e.jsxs("span",{className:"font-medium text-green-600",children:["₹",s.priceAfterDiscount.toFixed(2)]})]}),s.gstPercentage>0&&e.jsxs("div",{className:"flex justify-between items-center text-sm mb-1",children:[e.jsxs("span",{className:"text-blue-500",children:["GST (",s.gstPercentage,"%):"]}),e.jsxs("span",{className:"font-medium text-blue-500",children:["+₹",s.gstAmount.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between items-center text-base font-bold mt-2 pt-2 border-t border-gray-300",children:[e.jsx("span",{className:"text-gray-900",children:"Final Price:"}),e.jsxs("span",{className:"text-green-600",children:["₹",s.finalPrice.toFixed(2)]})]})]}),r&&e.jsxs("div",{className:"bg-white border border-green-200 rounded-lg p-3",children:[e.jsxs("div",{className:"text-lg font-bold text-green-600 mb-1",children:["Total: ₹",r.totalFinal.toFixed(2)]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[c," × ₹",s==null?void 0:s.finalPrice.toFixed(2)]})]})]})]})]})]},a)})]})}),e.jsxs("div",{className:"mt-6 grid grid-cols-1 sm:grid-cols-3 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"bg-white p-3 sm:p-4 rounded-xl shadow-sm flex items-center",children:[e.jsx(le,{className:"text-indigo-600 text-xl sm:text-2xl mr-3"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-sm",children:"Free Delivery"}),e.jsx("p",{className:"text-gray-500 text-xs",children:"On orders over ₹500"})]})]}),e.jsxs("div",{className:"bg-white p-3 sm:p-4 rounded-xl shadow-sm flex items-center",children:[e.jsx(v,{className:"text-indigo-600 text-xl sm:text-2xl mr-3"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-sm",children:"Easy Returns"}),e.jsx("p",{className:"text-gray-500 text-xs",children:"30-day return policy"})]})]}),e.jsxs("div",{className:"bg-white p-3 sm:p-4 rounded-xl shadow-sm flex items-center",children:[e.jsx(ne,{className:"text-indigo-600 text-xl sm:text-2xl mr-3"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-sm",children:"Secure Checkout"}),e.jsx("p",{className:"text-gray-500 text-xs",children:"100% secure payment"})]})]})]})]}),e.jsx("div",{className:"lg:w-1/3",children:e.jsxs("div",{className:"bg-white shadow-sm rounded-xl overflow-hidden sticky top-6",children:[e.jsxs("div",{className:"px-4 sm:px-6 py-4 sm:py-5 border-b border-gray-200",children:[e.jsx("h2",{className:"text-xl font-extrabold text-gray-900",children:t==="stockist"?"Stockist Order Summary":t==="reseller"?"Reseller Order Summary":"Order Summary"}),(t==="stockist"||t==="reseller")&&e.jsx("p",{className:"text-sm text-blue-600 mt-1",children:t==="stockist"?"Requires admin approval before processing":"Requires stockist approval before processing"})]}),e.jsxs("div",{className:"px-4 sm:px-6 py-4 space-y-3 sm:space-y-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("p",{className:"text-gray-600 font-medium",children:["Subtotal (",n.length," items)"]}),e.jsxs("p",{className:"text-gray-900 font-bold",children:["₹",u.subtotal.toFixed(2)]})]}),u.totalDiscount>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("p",{className:"text-gray-600 font-medium",children:"Total Discount:"}),e.jsxs("p",{className:"text-red-600 font-bold",children:["-₹",u.totalDiscount.toFixed(2)]})]}),u.totalDiscount>0&&e.jsxs("div",{className:"flex justify-between bg-green-50 p-2 rounded border border-green-100",children:[e.jsx("p",{className:"text-gray-700 font-medium",children:"Total After Discount:"}),e.jsxs("p",{className:"text-green-600 font-bold",children:["₹",u.totalPriceAfterDiscount.toFixed(2)]})]}),u.totalGst>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("p",{className:"text-gray-600 font-medium",children:"Total GST:"}),e.jsxs("p",{className:"text-blue-600 font-bold",children:["+₹",u.totalGst.toFixed(2)]})]}),t==="reseller"&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("p",{className:"text-gray-600 font-medium",children:"Shipping Price:"}),e.jsx("p",{className:"text-red-700 font-bold text-sm",children:"Calculated on Dispatching Time"})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-3 sm:pt-4 mt-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("p",{className:"text-lg font-extrabold text-gray-900",children:"Total Amount"}),e.jsxs("p",{className:"text-xl font-extrabold text-indigo-600",children:["₹",S.toFixed(2)]})]}),u.totalDiscount>0&&e.jsxs("p",{className:"text-xs text-green-600 text-right mt-1",children:["You saved ₹",u.totalDiscount.toFixed(2)," with ",t," discount!"]})]})]}),e.jsxs("div",{className:"px-4 sm:px-6 py-4 border-t border-gray-200",children:[e.jsx("button",{disabled:n.length===0||k,className:`w-full flex justify-center items-center px-6 py-3 sm:py-4 border border-transparent rounded-lg shadow-sm text-base font-extrabold text-white ${k||n.length===0?"bg-indigo-300 cursor-not-allowed":"bg-indigo-600 hover:bg-indigo-700 cursor-pointer"} focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors`,onClick:W,children:Y()}),e.jsx("div",{className:"mt-4 flex justify-center",children:e.jsx(B,{to:`/${t}/products`,className:"text-indigo-600 hover:text-indigo-500 text-sm font-bold cursor-pointer transition-colors",children:t==="stockist"?"Browse More Wholesale Products":t==="reseller"?"Browse More Reseller Products":"Continue Shopping"})})]})]})})]})]})})};export{he as default};
