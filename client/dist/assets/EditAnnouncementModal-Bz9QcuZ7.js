import{cA as P,r as h,j as e}from"./index-0HRytCPr.js";import{D as T,a as F,b as I,T as o,F as m,I as p,S as j,M as l,P as S,V as W,L as w,A as k,c as v,d as g,e as E,f as L,g as M}from"./AdapterDateFns-BWhNPv2A.js";import{T as b,A as U,G as s,B as _}from"./AnnouncementsPage-BdS98kWm.js";import"./index-D-omREhy.js";import"./addDays-RjdodTT7.js";import"./en-US-CEmq6YZe.js";import"./endOfMonth-12zbFdle.js";import"./format-PgvnqH7J.js";import"./index-CnyDuYXe.js";const K=({open:y,onClose:d,announcement:t})=>{const[f,{isLoading:c,error:u}]=P(),[r,x]=h.useState({title:"",content:"",priority:"medium",visible_to:"all",start_time:null,end_time:null,is_active:!0});h.useEffect(()=>{t&&x({title:t.title||"",content:t.content||"",priority:t.priority||"medium",visible_to:t.visible_to||"all",start_time:t.start_time?new Date(t.start_time):null,end_time:t.end_time?new Date(t.end_time):null,is_active:t.is_active!==void 0?t.is_active:!0})},[t]);const A=async i=>{i.preventDefault();try{await f({id:t.id,data:r}).unwrap(),d()}catch(n){console.error("Failed to update announcement:",n)}},a=i=>n=>{const C=n.target?n.target.value:n;x(D=>({...D,[i]:C}))};return t?e.jsxs(T,{open:y,onClose:d,maxWidth:"md",fullWidth:!0,PaperProps:{sx:{borderRadius:3}},children:[e.jsxs(F,{children:[e.jsx(b,{variant:"h5",component:"div",fontWeight:"bold",children:"Edit Announcement"}),e.jsx(b,{variant:"body2",color:"text.secondary",children:"Update announcement details"})]}),e.jsxs("form",{onSubmit:A,children:[e.jsxs(I,{children:[u&&e.jsxs(U,{severity:"error",sx:{mb:2},children:["Failed to update announcement: ",u.message]}),e.jsxs(s,{container:!0,spacing:3,children:[e.jsx(s,{item:!0,xs:12,children:e.jsx(o,{fullWidth:!0,label:"Title",value:r.title,onChange:a("title"),required:!0,variant:"outlined"})}),e.jsx(s,{item:!0,xs:12,children:e.jsx(o,{fullWidth:!0,label:"Content",value:r.content,onChange:a("content"),required:!0,multiline:!0,rows:4,variant:"outlined"})}),e.jsx(s,{item:!0,xs:12,md:6,children:e.jsxs(m,{fullWidth:!0,variant:"outlined",children:[e.jsx(p,{children:"Priority"}),e.jsxs(j,{value:r.priority,onChange:a("priority"),label:"Priority",startAdornment:e.jsx(S,{sx:{mr:1,color:"text.secondary"}}),children:[e.jsx(l,{value:"low",children:"Low"}),e.jsx(l,{value:"medium",children:"Medium"}),e.jsx(l,{value:"high",children:"High"}),e.jsx(l,{value:"critical",children:"Critical"})]})]})}),e.jsx(s,{item:!0,xs:12,md:6,children:e.jsxs(m,{fullWidth:!0,variant:"outlined",children:[e.jsx(p,{children:"Visible To"}),e.jsxs(j,{value:r.visible_to,onChange:a("visible_to"),label:"Visible To",startAdornment:e.jsx(W,{sx:{mr:1,color:"text.secondary"}}),children:[e.jsx(l,{value:"all",children:"All Users"}),e.jsx(l,{value:"vendor",children:"Vendors"}),e.jsx(l,{value:"reseller",children:"Resellers"}),e.jsx(l,{value:"stockist",children:"Stockists"})]})]})}),e.jsx(s,{item:!0,xs:12,children:e.jsx(w,{dateAdapter:k,children:e.jsxs(s,{container:!0,spacing:2,children:[e.jsx(s,{item:!0,xs:12,md:6,children:e.jsx(v,{label:"Start Time (Optional)",value:r.start_time,onChange:a("start_time"),renderInput:i=>e.jsx(o,{...i,fullWidth:!0,InputProps:{...i.InputProps,startAdornment:e.jsx(g,{sx:{mr:1,color:"text.secondary"}})}})})}),e.jsx(s,{item:!0,xs:12,md:6,children:e.jsx(v,{label:"End Time (Optional)",value:r.end_time,onChange:a("end_time"),renderInput:i=>e.jsx(o,{...i,fullWidth:!0,InputProps:{...i.InputProps,startAdornment:e.jsx(g,{sx:{mr:1,color:"text.secondary"}})}})})})]})})}),e.jsx(s,{item:!0,xs:12,children:e.jsx(E,{control:e.jsx(L,{checked:r.is_active,onChange:i=>a("is_active")(i.target.checked),color:"primary"}),label:"Active Announcement"})})]})]}),e.jsxs(M,{sx:{p:3,gap:1},children:[e.jsx(_,{onClick:d,variant:"outlined",disabled:c,children:"Cancel"}),e.jsx(_,{type:"submit",variant:"contained",disabled:c||!r.title||!r.content,sx:{background:"linear-gradient(45deg, #2196F3, #21CBF3)",borderRadius:2,px:4},children:c?"Updating...":"Update Announcement"})]})]})]}):null};export{K as default};
