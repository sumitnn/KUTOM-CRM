import{r as m,ai as H,aj as q,j as e}from"./index-oHO_bMXB.js";import{m as j,R as O,B as G,C as Q,X as K,Y as X,T as Y,n as J,o as U,F as Z}from"./FileSaver.min-CVl68mvK.js";import{f as r}from"./format-PgvnqH7J.js";import"./addDays-RjdodTT7.js";import"./en-US-CEmq6YZe.js";import"./index-DsfZBStp.js";import"./index-CnyDuYXe.js";const ce=()=>{var P;const w=new Date,[l,h]=m.useState({startDate:r(j(w,2),"yyyy-MM-dd"),endDate:r(w,"yyyy-MM-dd")}),[y,ee]=m.useState(""),[o,d]=m.useState(1),[b,T]=m.useState(10),[f,k]=m.useState("last_3_days"),[te,se]=m.useState(""),{data:n,isLoading:M,isError:D,refetch:_}=H({range:f,search:y,startDate:l.startDate,endDate:l.endDate}),[I]=q(),i=t=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0}).format(t),R=t=>{if(!t)return"N/A";try{const s=new Date(t);return isNaN(s.getTime())?"Invalid Date":r(s,"dd MMM yyyy")}catch{return"Invalid Date"}},C=t=>{const{name:s,value:a}=t.target;h(g=>({...g,[s]:a})),d(1),k("custom")},B=t=>{k(t),d(1);const s=new Date;switch(t){case"today":h({startDate:r(s,"yyyy-MM-dd"),endDate:r(s,"yyyy-MM-dd")});break;case"last_3_days":h({startDate:r(j(s,2),"yyyy-MM-dd"),endDate:r(s,"yyyy-MM-dd")});break;case"this_week":h({startDate:r(j(s,6),"yyyy-MM-dd"),endDate:r(s,"yyyy-MM-dd")});break;case"last_month":h({startDate:r(j(s,30),"yyyy-MM-dd"),endDate:r(s,"yyyy-MM-dd")});break}},F=t=>{T(Number(t.target.value)),d(1)},V=async()=>{try{const t=await I({range:f,search:y,startDate:l.startDate,endDate:l.endDate}).unwrap(),s=new Blob([t],{type:"text/csv"}),a=`sales_report_${l.startDate}_to_${l.endDate}.csv`;Z.saveAs(s,a)}catch(t){console.error("Export failed:",t)}},S={secondary:"#10b981"},p=(n==null?void 0:n.sales)||[],N=o*b,L=N-b,c=p.slice(L,N),x=Math.ceil(p.length/b),u=(n==null?void 0:n.summary)||{total_sales:0,total_quantity:0,total_orders:0},v=((P=n==null?void 0:n.charts)==null?void 0:P.top_products)||[],A=({active:t,payload:s,label:a})=>t&&s&&s.length?e.jsxs("div",{className:"bg-white p-3 border border-gray-200 rounded-lg shadow-lg",children:[e.jsx("p",{className:"font-semibold text-gray-900",children:R(a)}),s.map((g,$)=>e.jsxs("p",{className:"text-sm",style:{color:g.color},children:[g.name,": ",i(g.value)]},$))]}):null,E=t=>d(t),W=()=>d(t=>Math.min(t+1,x)),z=()=>d(t=>Math.max(t-1,1));return e.jsx("div",{className:"min-h-screen ",children:e.jsxs("div",{className:"max-w-8xl mx-auto py-4 ",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Sales Report"}),e.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Track and analyze your sales performance"})]}),e.jsx("div",{className:"mt-4 lg:mt-0 flex flex-col sm:flex-row gap-3",children:e.jsxs("button",{onClick:V,className:"px-6 py-2.5 cursor-pointer bg-green-600 text-white rounded-xl hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition-colors duration-200 font-medium shadow-sm flex items-center gap-2",children:[e.jsx("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Export CSV"]})})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsx("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 p-6 rounded-2xl shadow-lg text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-blue-100 text-sm font-medium",children:"Total Sales"}),e.jsx("p",{className:"text-3xl font-bold mt-2",children:i(u.total_sales||0)})]}),e.jsx("div",{className:"p-3 bg-blue-400/20 rounded-xl",children:e.jsx("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})})})]})}),e.jsx("div",{className:"bg-gradient-to-br from-green-500 to-green-600 p-6 rounded-2xl shadow-lg text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-green-100 text-sm font-medium",children:"Total Quantity"}),e.jsx("p",{className:"text-3xl font-bold mt-2",children:u.total_quantity||0})]}),e.jsx("div",{className:"p-3 bg-green-400/20 rounded-xl",children:e.jsx("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})})]})}),e.jsx("div",{className:"bg-gradient-to-br from-purple-500 to-purple-600 p-6 rounded-2xl shadow-lg text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-purple-100 text-sm font-medium",children:"Total Orders"}),e.jsx("p",{className:"text-3xl font-bold mt-2",children:u.total_orders||0})]}),e.jsx("div",{className:"p-3 bg-purple-400/20 rounded-xl",children:e.jsx("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})})})]})})]}),e.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6 mb-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date Range"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:[{key:"today",label:"Today"},{key:"last_3_days",label:"Last 3 Days"},{key:"this_week",label:"This Week"},{key:"last_month",label:"Last Month"}].map(({key:t,label:s})=>e.jsx("button",{onClick:()=>B(t),className:`px-3 py-1.5 rounded-lg cursor-pointer text-sm font-medium transition-all duration-200 ${f===t?"bg-blue-600 text-white shadow-sm":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:s},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Date"}),e.jsx("input",{type:"date",name:"startDate",className:"w-full px-3 py-2.5 cursor-pointer border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white",value:l.startDate,onChange:C})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm  font-medium text-gray-700 mb-2",children:"End Date"}),e.jsx("input",{type:"date",name:"endDate",className:"w-full px-3 py-2.5 border cursor-pointer border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white",value:l.endDate,onChange:C,min:l.startDate})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Items per page"}),e.jsxs("select",{className:"w-full px-3 py-2.5 cursor-pointer border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white",value:b,onChange:F,children:[e.jsx("option",{value:"10",children:"10"}),e.jsx("option",{value:"25",children:"25"}),e.jsx("option",{value:"50",children:"50"}),e.jsx("option",{value:"100",children:"100"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("button",{onClick:()=>_(),className:"w-full px-4 py-2.5 cursor-pointer bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-colors duration-200 font-medium flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh"]})})]})}),e.jsx("div",{className:"grid grid-cols-1 xl:grid-cols-1 gap-8 mb-8",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Top Products"}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"}),"Sales Amount"]})]}),e.jsx("div",{className:"h-80",children:e.jsx(O,{width:"100%",height:"100%",children:e.jsxs(G,{data:v,margin:{top:5,right:30,left:20,bottom:5},children:[e.jsx(Q,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),e.jsx(K,{dataKey:"product__name",angle:-45,textAnchor:"end",height:80,stroke:"#6b7280",fontSize:12}),e.jsx(X,{stroke:"#6b7280",fontSize:12,tickFormatter:t=>`â‚¹${t/1e3}k`}),e.jsx(Y,{content:e.jsx(A,{})}),e.jsx(J,{dataKey:"product_total",fill:S.secondary,radius:[4,4,0,0],children:v.map((t,s)=>e.jsx(U,{fill:S.secondary,opacity:.7+s*.3/v.length},`cell-${s}`))})]})})})]})}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden",children:[M&&e.jsxs("div",{className:"p-12 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600 font-medium",children:"Loading sales data..."})]}),D&&e.jsxs("div",{className:"p-12 text-center",children:[e.jsx("div",{className:"mx-auto w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Failed to load sales data"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Please check your connection and try again"}),e.jsx("button",{onClick:_,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:"Retry"})]}),!M&&!D&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-100",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Sales Details"}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[p.length," records found ",y&&`for "${y}"`]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-bold text-gray-800 uppercase ",children:"Product"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-bold text-gray-800 uppercase ",children:"Variant"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-bold text-gray-800 uppercase ",children:"Order Date"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-bold text-gray-800 uppercase ",children:"Quantity"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-bold text-gray-800 uppercase ",children:"Price (included GST And Discount)"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-bold text-gray-800 uppercase ",children:"Total Price (Without Shipping)"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:c.length>0?c.map((t,s)=>e.jsxs("tr",{className:"hover:bg-gray-50/50 transition-colors duration-150",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[t.product_image&&e.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:e.jsx("img",{className:"h-10 w-10 rounded-lg object-cover border border-gray-200",src:t.product_image,alt:t.product_name})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:t.product_name}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Order #",t.order_id]})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:t.variant_name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:r(new Date(t.order_date),"MMM dd, yyyy")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 font-medium",children:t.quantity}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:i(t.unit_price)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-bold text-gray-900",children:i(t.total_price)})]},t.id)):e.jsx("tr",{children:e.jsxs("td",{colSpan:"6",className:"px-6 py-12 text-center",children:[e.jsx("div",{className:"mx-auto w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No sales data found"}),e.jsx("p",{className:"text-gray-600",children:"Try adjusting your filters or search terms"})]})})}),c.length>0&&e.jsxs("tfoot",{className:"bg-gray-50 border-t border-gray-200",children:[e.jsxs("tr",{children:[e.jsx("td",{colSpan:"3",className:"px-6 py-3 text-right text-sm font-bold text-gray-700 uppercase",children:"Page Totals"}),e.jsx("td",{className:"px-6 py-3 whitespace-nowrap text-sm font-bold text-gray-900",children:c.reduce((t,s)=>t+s.quantity,0)}),e.jsx("td",{className:"px-6 py-3 whitespace-nowrap text-sm font-bold text-gray-900",children:"-"}),e.jsx("td",{className:"px-6 py-3 whitespace-nowrap text-sm font-bold text-gray-900",children:i(c.reduce((t,s)=>t+s.total_price,0))})]}),e.jsxs("tr",{children:[e.jsx("td",{colSpan:"3",className:"px-6 py-3 text-right text-sm font-bold text-gray-700 uppercase",children:"Grand Totals"}),e.jsx("td",{className:"px-6 py-3 whitespace-nowrap text-sm font-bold text-gray-900",children:u.total_quantity||0}),e.jsx("td",{className:"px-6 py-3 whitespace-nowrap text-sm font-bold text-gray-900",children:"-"}),e.jsx("td",{className:"px-6 py-3 whitespace-nowrap text-sm font-bold text-gray-900",children:i(u.total_sales||0)})]})]})]})}),c.length>0&&e.jsx("div",{className:"px-6 py-4 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["Showing ",e.jsx("span",{className:"font-medium",children:L+1})," to"," ",e.jsx("span",{className:"font-medium",children:Math.min(N,p.length)})," of"," ",e.jsx("span",{className:"font-medium",children:p.length})," results"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:z,disabled:o===1,className:"px-3 py-1.5 rounded-lg border border-gray-300 bg-white text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200",children:"Previous"}),e.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:Math.min(5,x)},(t,s)=>{let a;return x<=5||o<=3?a=s+1:o>=x-2?a=x-4+s:a=o-2+s,e.jsx("button",{onClick:()=>E(a),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors duration-200 ${o===a?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-100 border border-gray-300"}`,children:a},a)})}),e.jsx("button",{onClick:W,disabled:o===x,className:"px-3 py-1.5 rounded-lg border border-gray-300 bg-white text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200",children:"Next"})]})]})})]})]})]})})};export{ce as default};
