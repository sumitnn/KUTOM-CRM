const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ErrorMessage-D620Ebcm.js","assets/index-0HRytCPr.js","assets/index-DfS9FcIS.css"])))=>i.map(i=>d[i]);
import{r as p,cC as Z,cD as J,j as e,y as v,_ as L}from"./index-0HRytCPr.js";const X=p.lazy(()=>L(()=>import("./ErrorMessage-D620Ebcm.js"),__vite__mapDeps([0,1,2]))),ee=p.lazy(()=>L(()=>import("./index-0HRytCPr.js").then(a=>a.cH),__vite__mapDeps([1,2]))),r=["userDetails","documents","companyDetails","companyDocuments","paymentDetails"],m=({value:a,label:x,onPreview:j})=>{if(!a)return e.jsx("span",{className:"text-gray-500",children:"Not provided"});const d=a.split(".").pop().toLowerCase(),f=["jpg","jpeg","png","gif"].includes(d),i=d==="pdf";return e.jsxs("button",{className:"btn btn-xs sm:btn-sm btn-outline font-bold cursor-pointer",onClick:()=>j({url:a,title:x,type:f?"image":"file"}),children:["View ",x," (",f?"Image":i?"PDF":"File",")"]})};function se({vendor:a,onClose:x,role:j}){const[d,f]=p.useState(r[0]),[i,o]=p.useState(null),[u,g]=p.useState(!1),O={userDetails:"pending",userDetailsReason:"",documents:"pending",documentsReason:"",companyDetails:"pending",companyDetailsReason:"",companyDocuments:"pending",companyDocumentsReason:"",paymentDetails:"pending",paymentDetailsReason:""},[t,y]=p.useState(O),[M]=Z(),{data:l,isLoading:U,isError:G,refetch:q}=J(a==null?void 0:a.id);p.useEffect(()=>{l&&y({userDetails:l.user_details||"pending",userDetailsReason:l.user_details_reason||"",documents:l.documents||"pending",documentsReason:l.documents_reason||"",companyDetails:l.business_details||"pending",companyDetailsReason:l.business_details_reason||"",companyDocuments:l.company_documents||"pending",companyDocumentsReason:l.company_documents_reason||"",paymentDetails:l.bank_details||"pending",paymentDetailsReason:l.bank_details_reason||""})},[l]);const N=()=>r.some(s=>t[s]!=="pending"),_=(s,n,b="")=>{y(c=>({...c,[s]:n,[`${s}Reason`]:b}))},H=s=>{const n=t[`${s}Reason`];if(!n&&t[s]!=="rejected"){v.error("Please provide a rejection reason");return}_(s,"rejected",n)},V=s=>{_(s,"approved","")},z=(s,n)=>{y(b=>({...b,[`${s}Reason`]:n}))},K=async()=>{try{g(!0);const s={user_details:t.userDetails,user_details_reason:t.userDetailsReason,documents:t.documents,documents_reason:t.documentsReason,business_details:t.companyDetails,business_details_reason:t.companyDetailsReason,company_documents:t.companyDocuments,company_documents_reason:t.companyDocumentsReason,bank_details:t.paymentDetails,bank_details_reason:t.paymentDetailsReason};await M({userId:a==null?void 0:a.id,data:s}).unwrap(),x(),v.success("Profile Status Updated")}catch(s){console.error("Failed to update approval status:",s),v.error("Failed to submit approval. Please try again.")}finally{g(!1)}},Y=s=>{var k,D,w,C,P,R,S,A,I,$,E,F,T,B;const b={userDetails:{title:"User & Contact Information",fields:[{label:"Full Name",value:a.username},{label:"Email",value:a.email},{label:"Phone",value:a.phone},{label:"WhatsApp",value:a.profile.whatsapp_number},{label:"Date of Birth",value:a.profile.date_of_birth||"Not provided"},{label:"Gender",value:a.profile.gender||"Not provided"},{label:"KYC Status",value:a.profile.kyc_status},{label:"Address",value:a.address&&a.address.street_address&&a.address.city&&a.address.district&&a.address.state&&a.address.country&&a.address.postal_code?`${a.address.street_address}, ${a.address.city}, ${a.address.district}, ${a.address.state}, ${a.address.country} - ${a.address.postal_code}`:"Not provided"},{label:"Social Media",value:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.profile.facebook&&e.jsx("a",{href:a.profile.facebook,target:"_blank",rel:"noopener noreferrer",className:"link link-primary",children:"Facebook"}),a.profile.instagram&&e.jsx("a",{href:a.profile.instagram,target:"_blank",rel:"noopener noreferrer",className:"link link-primary",children:"Instagram"}),!a.profile.facebook&&!a.profile.instagram&&"Not provided"]})}]},documents:{title:"User Documents",fields:[{label:"Aadhaar Card",value:e.jsx(m,{value:a.profile.adhaar_card_pic,label:"Aadhaar Card",onPreview:o})},{label:"PAN Card",value:e.jsx(m,{value:a.profile.pancard_pic,label:"PAN Card",onPreview:o})},{label:"Profile Picture",value:e.jsx(m,{value:a.profile.profile_picture,label:"Profile Picture",onPreview:o})},{label:"Other Documents",value:e.jsx(m,{value:a.profile.kyc_other_document,label:"Other Document",onPreview:o})}]},companyDetails:{title:"Company Information",fields:[{label:"Company Name",value:((k=a.company)==null?void 0:k.company_name)||"Not provided"},{label:"Business Type",value:((D=a.company)==null?void 0:D.business_type)||"Not provided"},{label:"Business Category",value:((w=a.company)==null?void 0:w.business_category)||"Not provided"},{label:"Company Email",value:((C=a.company)==null?void 0:C.company_email)||"Not provided"},{label:"Company Phone",value:((P=a.company)==null?void 0:P.company_phone)||"Not provided"},{label:"GST Number",value:((R=a.company)==null?void 0:R.gst_number)||"Not provided"},{label:"PAN Number",value:((S=a.company)==null?void 0:S.pan_number)||"Not provided"},{label:"Business Description",value:((A=a.company)==null?void 0:A.business_description)||"Not provided"},{label:"Address",value:((I=a.company)==null?void 0:I.registered_address)||"Not provided"},{label:"Operational Address",value:(($=a.company)==null?void 0:$.operational_address)||"Not provided"}]},companyDocuments:{title:"Company Documents",fields:[{label:"GST Certificate",value:e.jsx(m,{value:(E=a.company)==null?void 0:E.gst_certificate,label:"GST Certificate",onPreview:o})},{label:"PAN Card",value:e.jsx(m,{value:(F=a.company)==null?void 0:F.pan_card,label:"Company PAN Card",onPreview:o})},{label:"Business Registration",value:e.jsx(m,{value:(T=a.company)==null?void 0:T.business_registration_doc,label:"Business Registration",onPreview:o})},{label:"Food License",value:e.jsx(m,{value:(B=a.company)==null?void 0:B.food_license_doc,label:"Food License",onPreview:o})}]},paymentDetails:{title:"Payment Information",fields:[{label:"Bank Name",value:a.profile.bank_name||"Not provided"},{label:"Account Holder",value:a.profile.account_holder_name||"Not provided"},{label:"Account Number",value:a.profile.account_number||"Not provided"},{label:"IFSC Code",value:a.profile.ifsc_code||"Not provided"},{label:"UPI ID",value:a.profile.upi_id||"Not provided"},{label:"Passbook/Cheque",value:e.jsx(m,{value:a.profile.passbook_pic,label:"Passbook/Cheque",onPreview:o})}]}}[s],c=t[s],Q=t[`${s}Reason`];return e.jsxs("div",{className:"space-y-4 md:space-y-6 ",children:[e.jsx("h4",{className:"text-lg md:text-xl font-bold text-primary",children:b.title}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 md:gap-6",children:b.fields.map((h,W)=>e.jsxs("div",{className:"bg-base-100 p-2 md:p-4 rounded-lg shadow-sm",children:[e.jsx("p",{className:"font-bold text-sm md:text-base text-gray-700 mb-1",children:h.label}),e.jsx("div",{className:"text-sm md:text-base text-gray-800",children:h.value})]},W))}),e.jsx("div",{className:"divider"}),e.jsxs("div",{className:"flex flex-col space-y-2 bg-base-200 p-3 md:p-4 rounded-lg",children:[e.jsx("label",{className:"label p-0",children:e.jsx("span",{className:"label-text font-bold text-sm md:text-base",children:c==="approved"?"Approval Note":"Rejection Reason"})}),e.jsx("textarea",{className:"textarea textarea-bordered h-20 md:h-24 focus:border-primary focus:ring-1 focus:ring-primary text-sm md:text-base",placeholder:c==="approved"?"Approval notes (optional)...":"Enter reason for rejection...",value:Q,onChange:h=>z(s,h.target.value),required:c==="rejected"})]}),e.jsxs("div",{className:"flex flex-wrap justify-center gap-3 md:gap-6 mt-4 md:mt-6",children:[e.jsx("button",{className:`btn btn-sm md:btn-md ${c==="rejected"?"btn-error":"btn-outline btn-error"} font-bold`,onClick:()=>H(s),disabled:u,children:c==="rejected"?"Rejected":"Reject"}),e.jsx("button",{className:`btn btn-sm md:btn-md ${c==="approved"?"btn-success":"btn-outline btn-success"} font-bold`,onClick:()=>V(s),disabled:u,children:c==="approved"?"Approved":"Approve"})]})]})};return U?e.jsxs("div",{className:"modal modal-open",children:[e.jsx("div",{className:"modal-backdrop backdrop-blur-sm"}),e.jsx("div",{className:"modal-box flex flex-col items-center justify-center",children:e.jsx(p.Suspense,{fallback:e.jsx("div",{children:"Loading..."}),children:e.jsx(ee,{fullScreen:!1})})})]}):G?e.jsxs("div",{className:"modal modal-open",children:[e.jsx("div",{className:"modal-backdrop backdrop-blur-sm"}),e.jsxs("div",{className:"modal-box",children:[e.jsx(p.Suspense,{fallback:e.jsx("div",{children:"Loading error component..."}),children:e.jsx(X,{message:"Failed to load approval status. Please try again.",onRetry:q})}),e.jsx("div",{className:"modal-action",children:e.jsx("button",{className:"btn btn-primary",onClick:x,children:"Close"})})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"modal modal-open",children:[e.jsx("div",{className:"modal-backdrop backdrop-blur-sm bg-black/30"}),e.jsxs("div",{className:"modal-box w-11/12 max-w-5xl max-h-[90vh] flex flex-col p-2 md:p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 md:mb-6",children:[e.jsxs("h3",{className:"font-bold text-lg md:text-2xl text-primary",children:[j," details"]}),e.jsx("button",{className:"btn btn-sm btn-circle btn-ghost hover:bg-error hover:text-white",onClick:x,children:"✕"})]}),e.jsx("div",{className:"flex flex-nowrap overflow-x-auto pb-2 mb-4 md:mb-6",children:e.jsx("div",{className:"tabs tabs-boxed bg-base-200 flex-nowrap whitespace-nowrap",style:{minHeight:"5rem"},children:r.map(s=>{const n=t[s];return e.jsxs("button",{className:`tab text-xs md:text-sm font-semibold h-10 px-4 flex-shrink-0 ${d===s?"tab-active":""} ${n==="approved"?"!bg-green-100 !text-green-800 border-green-300":n==="rejected"?"!bg-red-100 !text-red-800 border-red-300":""}`,onClick:()=>f(s),disabled:u,children:[s.replace(/([A-Z])/g," $1").replace(/^./,b=>b.toUpperCase()),n!=="pending"&&e.jsx("span",{className:"ml-1",children:n==="approved"?"✓":"✗"})]},s)})})}),e.jsx("div",{className:"flex-grow overflow-y-auto p-1 md:p-4",children:Y(d)}),e.jsx("div",{className:"modal-action mt-4 md:mt-6",children:e.jsxs("div",{className:"flex justify-between w-full",children:[d!==r[0]&&e.jsx("button",{className:"btn btn-sm md:btn-md btn-outline font-bold",onClick:()=>{const s=r.indexOf(d);f(r[s-1])},disabled:u,children:"← Previous"}),d!==r[r.length-1]?e.jsx("button",{className:"btn btn-sm md:btn-md btn-primary font-bold ml-auto",onClick:()=>{const s=r.indexOf(d);f(r[s+1])},disabled:u,children:"Next →"}):e.jsx("button",{className:`btn btn-sm md:btn-md btn-success font-bold ml-auto ${!N()||u?"btn-disabled":""}`,onClick:K,disabled:!N()||u,children:u?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"loading loading-spinner"}),"Submitting..."]}):"Submit Review"})]})})]})]}),i&&e.jsxs("div",{className:"modal modal-open",children:[e.jsx("div",{className:"modal-backdrop backdrop-blur-md bg-black/40"}),e.jsxs("div",{className:"modal-box w-11/12 max-w-5xl max-h-screen",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"font-bold text-lg md:text-xl",children:i.title}),e.jsx("button",{className:"btn btn-sm btn-circle btn-ghost hover:bg-error hover:text-white",onClick:()=>o(null),children:"✕"})]}),e.jsx("div",{className:"flex justify-center items-center h-full min-h-[50vh]",children:i.type==="image"?e.jsx("img",{src:i.url,alt:i.title,className:"max-h-[70vh] md:max-h-[80vh] object-contain"}):e.jsxs("div",{className:"w-full h-full",children:[e.jsx("iframe",{src:i.url,title:i.title,className:"w-full h-[70vh] md:h-[80vh] border rounded-lg"}),e.jsx("div",{className:"mt-4 text-center",children:e.jsx("a",{href:i.url,target:"_blank",rel:"noopener noreferrer",className:"btn btn-primary",children:"Open in New Tab"})})]})}),e.jsx("div",{className:"modal-action",children:e.jsx("button",{className:"btn btn-sm md:btn-md btn-primary",onClick:()=>o(null),children:"Close"})})]})]})]})}export{se as default};
