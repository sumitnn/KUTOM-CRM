import{c as de,a as xe,u as me,Z as ue,bI as ge,r as v,j as e,L as M,y as _,bJ as be}from"./index-0HRytCPr.js";import{s as he,Y as F,x as O,k as J,$ as pe,X as fe,D as je,l as Ne,a0 as ye}from"./index--WZidvUd.js";/* empty css                      */const N=(s,n)=>{var o;if(!((o=s==null?void 0:s.bulk_prices)!=null&&o.length))return null;const c=[...s.bulk_prices].sort((i,p)=>i.max_quantity-p.max_quantity);let l=null;for(const i of c)if(n>=i.max_quantity)l=i;else break;return l},ve=(s,n)=>{var l;const c=N(s,n);if(c)return Number(c.final_price);if((l=s==null?void 0:s.product_variant_prices)!=null&&l[0]){const o=s.product_variant_prices[0];return Number(o.actual_price)}return 0},_e=(s,n)=>{var l;const c=N(s,n);if(c)return Number(c.price)*n*Number(c.gst_percentage)/100;if((l=s==null?void 0:s.product_variant_prices)!=null&&l[0]){const o=s.product_variant_prices[0];return Number(o.price)*(1-o.discount/100)*Number(o.gst_percentage)/100*n}return 0},we=(s,n)=>{var l;const c=N(s,n);if(c){const o=se(s),i=Number(c.price);return(o-i)*n}if((l=s==null?void 0:s.product_variant_prices)!=null&&l[0]){const o=s.product_variant_prices[0];return Number(o.price)*(o.discount/100)*n}return 0},se=s=>{var n;if((n=s==null?void 0:s.product_variant_prices)!=null&&n[0]){const c=s.product_variant_prices[0];return Number(c.price)}return 0},H=s=>{var n;if((n=s==null?void 0:s.product_variant_prices)!=null&&n[0]){const c=s.product_variant_prices[0];return Number(c.actual_price)}return 0},ee=s=>{var n,c;return(c=(n=s==null?void 0:s.product_variant_prices)==null?void 0:n[0])!=null&&c.total_available_quantity?Number(s.product_variant_prices[0].total_available_quantity):0},Pe=(s,n)=>{var l;const c=N(s,n);return c?Number(c.discount):(l=s==null?void 0:s.product_variant_prices)!=null&&l[0]?s.product_variant_prices[0].discount:0},Ae=(s,n)=>{var l;const c=N(s,n);return c?Number(c.gst_percentage):(l=s==null?void 0:s.product_variant_prices)!=null&&l[0]?s.product_variant_prices[0].gst_percentage:0},ke=(s,n)=>{var l;const c=N(s,n);if(c)return Number(c.price)*n;if((l=s==null?void 0:s.product_variant_prices)!=null&&l[0]){const o=s.product_variant_prices[0],i=Number(o.price),p=i*(o.discount/100);return(i-p)*n}return 0},Ie=({role:s})=>{var K,R,W,X;const{id:n}=de(),c=xe(),l=me(),o=ue(t=>t.cart.items),{data:i,error:p,isLoading:$}=ge(n),[r,Q]=v.useState(null),[x,w]=v.useState(1),[I,U]=v.useState(null),[A,q]=v.useState(!1),[G,te]=v.useState({x:50,y:50}),a=i==null?void 0:i.product_detail,y=(i==null?void 0:i.variants_detail)||[],h=i==null?void 0:i.is_featured;v.useEffect(()=>{var t,d,m,f;if(a&&(U(((d=(t=a.images)==null?void 0:t.find(j=>j.is_featured))==null?void 0:d.image)||((f=(m=a.images)==null?void 0:m[0])==null?void 0:f.image)||"/placeholder.png"),y.length>0)){const j=y.find(T=>T.is_default)||y[0];Q(j)}},[a,y]);const Y=t=>{if(!t)return null;const d=/(?:https?:\/\/)?(?:www\.)?(?:youtube\.com\/watch\?v=|youtu\.be\/)([\w-]{11})/,m=t.match(d);return m?`https://www.youtube.com/embed/${m[1]}`:null},re=t=>{const{left:d,top:m,width:f,height:j}=t.currentTarget.getBoundingClientRect(),T=(t.pageX-d)/f*100,oe=(t.pageY-m)/j*100;te({x:T,y:oe})};o.some(t=>{var d;return t.id===(a==null?void 0:a.id)&&((d=t.variant)==null?void 0:d.id)===(r==null?void 0:r.id)});const u=r?N(r,x):null,P=u!==null,L=r?ve(r,x):0,C=r?_e(r,x):0,V=r?we(r,x):0,z=r?se(r):0,D=r?H(r):0,g=r?ee(r):0,B=r?Pe(r,x):0,E=r?Ae(r,x):0,ae=r?ke(r,x):0,k=()=>P?(L*x).toFixed(2):(D*x).toFixed(2),Z=()=>(z*x).toFixed(2),ie=t=>{const d=parseInt(t.target.value)||1,m=Math.max(1,d);if(g>0&&m>g){_.error(`Only ${g} units available for this variant`);return}w(m)},ne=()=>{S||w(t=>t+1)},ce=()=>{x>1&&w(t=>t-1)},le=()=>{if(!r){_.warning("Please select a variant before adding to cart.");return}if(g===0){_.error("This product variant is currently out of stock");return}if(x>g){_.error(`Only ${g} units available for this variant`);return}const t=`${a.id}_${r.id}`;if(o.find(f=>f.cartItemId===t)){_.info("This variant is already in your cart.");return}const m={id:i.id,product_id:a.id,cartItemId:t,name:a.name,price:L,actual_price:D,gst_percentage:E,gst_amount:C,final_price:Number(k()),quantity:x,image:I,variant:r,bulk_price:u,max_available:g};l(be(m)),_.success(`${x} item(s) added to cart!`),w(1)};if($)return e.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:e.jsx("span",{className:"loading loading-lg loading-spinner text-primary"})});if(p||!a)return e.jsxs("div",{className:"text-center py-10",children:[e.jsx("h2",{className:"text-xl font-bold text-red-600",children:"Product not found"}),e.jsx(M,{to:`/${s}/products`,className:"btn btn-outline mt-4 cursor-pointer",children:"Back to Products"})]});const b=g===0,S=x>=g;return e.jsxs("div",{className:"max-w-8xl mx-auto py-4",children:[e.jsxs("button",{onClick:()=>c(`/${s}/products`),className:"btn btn-ghost btn-sm mb-4 cursor-pointer flex items-center gap-2",children:[e.jsx(he,{className:"text-lg"}),"Back to Products"]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-12",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative w-full h-80 sm:h-96 lg:h-[500px] border-2 bg-gray-50 overflow-hidden rounded-2xl cursor-zoom-in shadow-sm",onClick:()=>q(!A),onMouseMove:A?re:null,onMouseLeave:()=>q(!1),children:[e.jsx("img",{src:I,alt:a.name,className:`w-full h-full object-contain transition-transform duration-300 ${A?"scale-150":"scale-100"}`,style:{transformOrigin:`${G.x}% ${G.y}%`}}),A&&e.jsx("div",{className:"absolute bottom-4 left-4 bg-black/70 text-white px-3 py-2 rounded-full text-sm backdrop-blur-sm",children:"Click to zoom out"})]}),e.jsx("div",{className:"flex gap-3 overflow-x-auto pb-4 px-1",children:(K=a.images)==null?void 0:K.map(t=>e.jsx("img",{src:t.image,alt:"thumb",className:`w-16 h-16 sm:w-20 sm:h-20 object-cover border-2 rounded-lg cursor-pointer flex-shrink-0 transition-all ${I===t.image?"border-primary shadow-md scale-105":"border-gray-300 hover:border-gray-400"}`,onClick:()=>U(t.image)},t.id))}),a.video_url&&Y(a.video_url)&&e.jsxs("div",{className:"mt-8 p-4 bg-white rounded-2xl shadow-sm border",children:[e.jsxs("h3",{className:"text-lg font-bold mb-3 flex items-center gap-2",children:[e.jsx(F,{className:"text-yellow-500"}),"Product Video"]}),e.jsx("div",{className:"aspect-w-16 aspect-h-9",children:e.jsx("iframe",{src:Y(a.video_url),className:"w-full h-48 sm:h-64 rounded-xl border-0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,title:"Product video"})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"text-sm breadcrumbs text-gray-600",children:e.jsxs("ul",{children:[e.jsx("li",{children:e.jsx(M,{to:`/${s}/products`,className:"cursor-pointer hover:text-primary",children:"Products"})}),e.jsx("li",{children:e.jsx(M,{to:`/${s}/products`,className:"cursor-pointer hover:text-primary",children:a.category_name})}),e.jsx("li",{className:"text-primary font-semibold",children:a.name})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 leading-tight",children:a.name}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[e.jsxs("span",{children:["SKU: ",e.jsx("strong",{className:"font-mono",children:a.sku})]}),h&&e.jsxs("span",{className:"flex items-center gap-1 bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full",children:[e.jsx(F,{className:"text-xs"}),"Active"]}),!h&&e.jsxs("span",{className:"flex items-center gap-1 bg-red-100 text-red-800 px-2 py-1 rounded-full",children:[e.jsx(F,{className:"text-xs"}),"In-Active"]}),b&&e.jsx("span",{className:"flex items-center gap-1 bg-red-100 text-red-800 px-2 py-1 rounded-full",children:"Out of Stock"})]})]}),r&&e.jsxs("div",{className:`p-4 rounded-2xl border ${b?"bg-red-50 border-red-200":"bg-blue-50 border-blue-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-semibold",children:b?"Out of Stock":"Available Quantity:"}),e.jsx("span",{className:`font-bold ${b?"text-red-700":"text-blue-700"}`,children:b?"0 units":`${g} units`})]}),!b&&x>g&&e.jsx("div",{className:"mt-2 text-sm text-red-600",children:"You cannot order more than available stock"})]}),e.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-blue-50 p-6 rounded-2xl border border-green-100",children:[e.jsxs("div",{className:"flex items-baseline gap-3 flex-wrap",children:[e.jsxs("div",{className:"text-3xl font-bold text-green-700",children:["â‚¹",k(),P&&e.jsx("span",{className:"ml-2 text-sm bg-green-100 text-green-800 px-2 py-1 rounded-full",children:"Bulk Price"})]}),z>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-xl text-gray-500 line-through",children:["â‚¹",Z()]}),B>0&&e.jsxs("span",{className:"bg-red-100 text-red-700 px-2 py-1 rounded-full text-sm font-bold",children:[B,"% OFF"]})]})]}),e.jsxs("div",{className:"mt-3 space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between text-gray-600",children:[e.jsxs("span",{children:["Original Price (",x," items):"]}),e.jsxs("span",{className:"font-semibold",children:["â‚¹",Z()]})]}),V>0&&e.jsxs("div",{className:"flex justify-between text-green-600",children:[e.jsxs("span",{children:["Discount (",B,"%):"]}),e.jsxs("span",{className:"font-semibold",children:["-â‚¹",V.toFixed(2)]})]}),!P&&e.jsxs("div",{className:"flex justify-between text-gray-600",children:[e.jsx("span",{children:"Price after discount:"}),e.jsxs("span",{className:"font-semibold",children:["â‚¹",ae.toFixed(2)]})]}),C>0&&e.jsxs("div",{className:"flex justify-between text-gray-600",children:[e.jsxs("span",{children:["GST (",E,"%):"]}),e.jsxs("span",{className:"font-semibold",children:["+â‚¹",C.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between text-lg font-bold text-gray-900 border-t pt-2",children:[e.jsx("span",{children:"Total Price:"}),e.jsxs("span",{className:"text-green-700",children:["â‚¹",k()]})]})]}),P&&e.jsxs("div",{className:"mt-3 p-3 bg-white rounded-lg border border-green-200",children:[e.jsxs("div",{className:"text-sm text-green-700 font-semibold flex items-center gap-2",children:[e.jsx(O,{className:"text-green-600"}),"ðŸŽ‰ Bulk discount applied! (Minimum ",u==null?void 0:u.max_quantity," units)"]}),e.jsxs("div",{className:"text-xs text-blue-600 mt-1",children:["You're saving ",u==null?void 0:u.discount,"% + GST benefits compared to regular pricing"]})]})]}),y.length>0&&e.jsxs("div",{className:"bg-white p-5 rounded-2xl border border-gray-200 shadow-sm",children:[e.jsxs("p",{className:"font-semibold text-gray-800 mb-4 text-lg flex items-center gap-2",children:[e.jsx(J,{className:"text-green-500"}),"Available Variants"]}),e.jsx("div",{className:"flex flex-wrap gap-3",children:y.map(t=>{const d=ee(t),m=d===0;return e.jsx("button",{onClick:()=>{Q(t),w(1)},disabled:!t.is_active||m,className:`px-5 py-4 rounded-xl text-base font-semibold border-2 cursor-pointer transition-all min-w-[120px] ${(r==null?void 0:r.id)===t.id?"bg-primary text-white border-primary shadow-lg transform scale-105":"border-gray-300 bg-white hover:border-gray-400 hover:shadow-md"} ${!t.is_active||m?"opacity-50 cursor-not-allowed grayscale":""}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-bold",children:t.name}),e.jsx("div",{className:"text-sm font-normal mt-1 opacity-90",children:t.is_default&&"(Default)"}),m&&e.jsx("div",{className:"text-xs text-red-600 mt-1",children:"Out of Stock"}),!m&&e.jsxs("div",{className:"text-xs text-green-600 mt-1",children:[d," available"]})]})},t.id)})})]}),((R=r==null?void 0:r.bulk_prices)==null?void 0:R.length)>0&&e.jsxs("div",{className:"bg-white p-5 rounded-2xl border border-gray-200 shadow-sm",children:[e.jsxs("p",{className:"font-semibold text-gray-800 mb-4 text-lg flex items-center gap-2",children:[e.jsx(O,{className:"text-blue-500"}),"Bulk Pricing Tiers"]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b-2 border-gray-100",children:[e.jsx("th",{className:"text-left pb-3 font-bold text-gray-900",children:"Minimum Quantity"}),e.jsx("th",{className:"text-right pb-3 font-bold text-gray-900",children:"Base Price"}),e.jsx("th",{className:"text-right pb-3 font-bold text-gray-900",children:"Discount"}),e.jsx("th",{className:"text-right pb-3 font-bold text-gray-900",children:"GST"}),e.jsx("th",{className:"text-right pb-3 font-bold text-gray-900",children:"Final Price"}),e.jsx("th",{className:"text-right pb-3 font-bold text-gray-900",children:"You Save"})]})}),e.jsx("tbody",{children:[...r.bulk_prices].sort((t,d)=>t.max_quantity-d.max_quantity).map(t=>{const f=((H(r)-Number(t.final_price)).toFixed(2)*t.max_quantity).toFixed(2),j=(u==null?void 0:u.id)===t.id;return e.jsxs("tr",{className:`border-b border-gray-100 hover:bg-gray-50 transition-colors ${j?"bg-blue-50 font-semibold":""}`,children:[e.jsxs("td",{className:"py-3 font-semibold",children:[t.max_quantity," + units",j&&e.jsx("div",{className:"text-xs text-green-600 mt-1",children:"âœ“ Applied to your cart"})]}),e.jsxs("td",{className:"text-right",children:["â‚¹",t.price]}),e.jsxs("td",{className:"text-right text-green-600 font-semibold",children:[t.discount,"%"]}),e.jsxs("td",{className:"text-right text-blue-600 font-semibold",children:[t.gst_percentage,"%"]}),e.jsxs("td",{className:"text-right font-bold text-green-600",children:["â‚¹",t.final_price,"/unit"]}),e.jsxs("td",{className:"text-right text-orange-600 font-semibold",children:["â‚¹",f," total"]})]},t.id)})})]})}),e.jsx("div",{className:"mt-3 text-xs text-gray-600",children:"* Savings calculated compared to regular single unit pricing"})]}),["admin","reseller"].includes(s)&&e.jsxs("div",{className:"bg-white p-5 rounded-2xl border border-gray-200 shadow-sm space-y-5",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-semibold text-lg text-gray-800",children:"Quantity:"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:ce,className:"btn btn-circle btn-outline cursor-pointer hover:bg-gray-100 transition-colors",disabled:b||!h||x<=1,children:e.jsx(pe,{})}),e.jsx("input",{type:"number",min:"1",max:g,value:x,onChange:ie,className:"w-20 text-center border-2 border-gray-300 rounded-xl py-2 text-lg font-bold focus:border-primary focus:ring-2 focus:ring-primary/20 transition-colors",disabled:b||!h}),e.jsx("button",{onClick:ne,className:`btn btn-circle btn-outline transition-colors ${S?"cursor-not-allowed opacity-50":"cursor-pointer hover:bg-gray-100"}`,disabled:b||!h||S,title:S?`Maximum ${g} units available`:"",children:e.jsx(fe,{})})]})]}),P&&e.jsxs("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 text-green-700",children:[e.jsx(O,{className:"text-green-600"}),e.jsxs("span",{className:"font-semibold",children:["Bulk pricing active! You're saving ",u==null?void 0:u.discount,"% + GST benefits"]})]}),e.jsxs("div",{className:"text-sm text-green-600 mt-1",children:["Minimum ",u==null?void 0:u.max_quantity," units required for this price"]})]}),e.jsx("div",{className:"flex flex-col sm:flex-row gap-3",children:e.jsxs("button",{onClick:le,className:`btn btn-lg flex-1 flex items-center justify-center gap-2 transition-all duration-300 ${b||!h||!r?"btn-disabled cursor-not-allowed":"btn-primary cursor-pointer hover:shadow-lg"}`,disabled:b||!h||!r,children:[e.jsx(je,{className:"text-md"}),b?"Out of Stock":h?r?`Add to Cart - â‚¹${k()}`:"Select Variant":"Product Unavailable"]})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white p-5 rounded-2xl border border-gray-200 shadow-sm",children:[e.jsxs("h2",{className:"text-xl font-bold mb-4 text-gray-900 flex items-center gap-2",children:[e.jsx(J,{className:"text-blue-500"}),"Product Description"]}),e.jsx("p",{className:"text-gray-700 leading-relaxed",children:a.description||"No description available."})]}),((W=a.features)==null?void 0:W.length)>0&&e.jsxs("div",{className:"bg-white p-5 rounded-2xl border border-gray-200 shadow-sm",children:[e.jsxs("h2",{className:"text-xl font-bold mb-4 text-gray-900 flex items-center gap-2",children:[e.jsx(F,{className:"text-yellow-500"}),"Key Features"]}),e.jsx("ul",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:a.features.map((t,d)=>e.jsxs("li",{className:"flex items-center gap-3 text-gray-700 p-2 hover:bg-gray-50 rounded-lg transition-colors",children:[e.jsx("div",{className:"w-2 h-2 bg-primary rounded-full flex-shrink-0"}),e.jsx("span",{children:t})]},d))})]}),e.jsxs("div",{className:"bg-white p-5 rounded-2xl border border-gray-200 shadow-sm",children:[e.jsxs("h2",{className:"text-xl font-bold mb-4 text-gray-900 flex items-center gap-2",children:[e.jsx(Ne,{className:"text-purple-500"}),"Specifications"]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 text-gray-700",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between py-2 border-b border-gray-100",children:[e.jsx("strong",{className:"text-gray-900",children:"Brand:"}),e.jsx("span",{children:a.brand_name||"N/A"})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b border-gray-100",children:[e.jsx("strong",{className:"text-gray-900",children:"Category:"}),e.jsx("span",{children:a.category_name||"N/A"})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b border-gray-100",children:[e.jsx("strong",{className:"text-gray-900",children:"Subcategory:"}),e.jsx("span",{children:a.subcategory_name||"N/A"})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b border-gray-100",children:[e.jsx("strong",{className:"text-gray-900",children:"Weight:"}),e.jsxs("span",{children:[a.weight," ",a.weight_unit]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between py-2 border-b border-gray-100",children:[e.jsx("strong",{className:"text-gray-900",children:"Dimensions:"}),e.jsx("span",{children:a.dimensions})]}),e.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[e.jsx("strong",{className:"text-gray-900",children:"Status:"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:`badge font-bold ${a.status==="published"?"badge-success":"badge-warning"}`,children:a.status||"draft"}),e.jsx("span",{className:`badge font-bold ${h?"badge-success":"badge-secondary"}`,children:h?"Active":"Inactive"})]})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b border-gray-100",children:[e.jsx("strong",{className:"text-gray-900",children:"Warranty:"}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ye,{className:"text-green-500"}),a.warranty||"0"," year(s)"]})]}),r&&e.jsxs("div",{className:"flex justify-between py-2 border-b border-gray-100",children:[e.jsx("strong",{className:"text-gray-900",children:"Variant SKU:"}),e.jsx("span",{className:"font-mono",children:r.sku})]})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 p-5 rounded-2xl border border-blue-200",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3 text-lg",children:"Vendor Information"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-primary text-white rounded-full flex items-center justify-center font-bold text-lg shadow-md",children:((X=i==null?void 0:i.user_name)==null?void 0:X.charAt(0))||"V"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-gray-900",children:(i==null?void 0:i.user_name)||"N/A"}),e.jsxs("p",{className:"text-sm text-gray-600 font-bold",children:["Vendor ID: ",(i==null?void 0:i.user_unique_id)||"N/A"]})]})]})]})]})]})]})]})};export{we as calculateDiscountForItem,_e as calculateGSTForItem,ve as calculateItemPrice,Ie as default,H as getActualPrice,N as getApplicableBulkPrice,se as getBasePrice,Pe as getDiscountPercentage,Ae as getGSTPercentage,ee as getMaxAvailableQuantity,ke as getPriceAfterDiscount};
